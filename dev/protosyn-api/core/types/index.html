<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Types · ProtoSyn.jl</title><script data-outdated-warner src="../../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.044/juliamono.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../assets/themeswap.js"></script><link href="../../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../../"><img src="../../../assets/logo.png" alt="ProtoSyn.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../../">ProtoSyn.jl</a></span></div><form class="docs-search" action="../../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../../">Home</a></li><li><span class="tocitem">Getting Started</span><ul><li><a class="tocitem" href="../../../getting-started/installation/">Installation</a></li><li><a class="tocitem" href="../../../getting-started/first-steps/">First steps</a></li><li><a class="tocitem" href="../../../getting-started/examples/">Examples</a></li></ul></li><li><span class="tocitem">ProtoSyn API</span><ul><li><input class="collapse-toggle" id="menuitem-3-1" type="checkbox" checked/><label class="tocitem" for="menuitem-3-1"><span class="docs-label">Core</span><i class="docs-chevron"></i></label><ul class="collapsed"><li class="is-active"><a class="tocitem" href>Types</a><ul class="internal"><li><a class="tocitem" href="#pose-types"><span>Pose</span></a></li><li><a class="tocitem" href="#fragment-types"><span>Fragment</span></a></li><li><a class="tocitem" href="#graph-types"><span>Graph</span></a></li><li><a class="tocitem" href="#state-types"><span>State</span></a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-1-2" type="checkbox"/><label class="tocitem" for="menuitem-3-1-2"><span class="docs-label">Methods</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../methods/graph/">Graph</a></li><li><a class="tocitem" href="../methods/state/">State</a></li><li><a class="tocitem" href="../methods/pose/">Pose</a></li><li><a class="tocitem" href="../methods/io/">Input and Output (IO)</a></li><li><a class="tocitem" href="../methods/other/">Auxiliary methods</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-1-3" type="checkbox"/><label class="tocitem" for="menuitem-3-1-3"><span class="docs-label">Calculators</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../calculators/calculators-section/">Calculators Section</a></li><li><a class="tocitem" href="../calculators/torchani/">TorchANI</a></li><li><a class="tocitem" href="../calculators/bond-distance-restraint/">Bond distance Restraint</a></li><li><a class="tocitem" href="../calculators/potential-restraints/">Potential Restraints</a></li><li><a class="tocitem" href="../calculators/electrostatics/">Electrostatics</a></li><li><a class="tocitem" href="../calculators/gb-solvation/">Generalized Born</a></li><li><a class="tocitem" href="../calculators/sasa/">SASA</a></li><li><a class="tocitem" href="../calculators/hydrogen-bonds/">Hydrogen Bonds</a></li><li><a class="tocitem" href="../calculators/radius-gyration/">Radius of gyration</a></li><li><a class="tocitem" href="../calculators/custom-ref-energy/">Custom reference energy</a></li><li><a class="tocitem" href="../calculators/ref15/">REF-15</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-1-4" type="checkbox"/><label class="tocitem" for="menuitem-3-1-4"><span class="docs-label">Mutators</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../mutators/mutators-section/">Mutators Section</a></li><li><a class="tocitem" href="../mutators/mutators-dihedral/">Dihedral Mutator</a></li><li><a class="tocitem" href="../mutators/mutators-crankshaft/">Crankshaft Mutator</a></li><li><a class="tocitem" href="../mutators/mutators-rigid-body/">Rigid Body Mutators</a></li><li><a class="tocitem" href="../mutators/mutators-backrub/">Backrub Mutators</a></li><li><a class="tocitem" href="../mutators/mutators-compound/">Compound Mutators</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-1-5" type="checkbox"/><label class="tocitem" for="menuitem-3-1-5"><span class="docs-label">Drivers</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../drivers/drivers-section/">Drivers Section</a></li><li><a class="tocitem" href="../drivers/drivers-monte-carlo/">Monte Carlo</a></li><li><a class="tocitem" href="../drivers/drivers-steepest-descent/">Steepest Descent</a></li><li><a class="tocitem" href="../drivers/drivers-ils/">ILS</a></li><li><a class="tocitem" href="../drivers/drivers-compound/">Compound Driver</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-1-6" type="checkbox"/><label class="tocitem" for="menuitem-3-1-6"><span class="docs-label">Submodules</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../submodules/selections/">Selections</a></li><li><a class="tocitem" href="../submodules/builder/">Builder</a></li><li><a class="tocitem" href="../submodules/external-packages/">External packages</a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-2" type="checkbox"/><label class="tocitem" for="menuitem-3-2"><span class="docs-label">Peptides</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../peptides/introduction/">Introduction</a></li><li><a class="tocitem" href="../../peptides/types/">Types</a></li><li><input class="collapse-toggle" id="menuitem-3-2-3" type="checkbox"/><label class="tocitem" for="menuitem-3-2-3"><span class="docs-label">Methods</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../peptides/methods/io/">Input and Output (IO)</a></li><li><a class="tocitem" href="../../peptides/methods/graph/">Graph</a></li><li><a class="tocitem" href="../../peptides/methods/state/">State</a></li><li><a class="tocitem" href="../../peptides/methods/pose/">Pose</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-2-4" type="checkbox"/><label class="tocitem" for="menuitem-3-2-4"><span class="docs-label">Calculators</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../peptides/calculators/potential-restraints/">Potential Restraints</a></li><li><a class="tocitem" href="../../peptides/calculators/electrostatics/">Electrostatics</a></li><li><a class="tocitem" href="../../peptides/calculators/sasa/">SASA</a></li><li><a class="tocitem" href="../../peptides/calculators/natural-frequency/">Natural frequency</a></li><li><a class="tocitem" href="../../peptides/calculators/ss-propensity/">Secondary structure propensity</a></li><li><a class="tocitem" href="../../peptides/calculators/caterpillar-solvation/">Caterpilar solvation model</a></li><li><a class="tocitem" href="../../peptides/calculators/seqdes/">SeqDes model</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-2-5" type="checkbox"/><label class="tocitem" for="menuitem-3-2-5"><span class="docs-label">Mutators</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../peptides/mutators/rotamer/">Rotamer Mutator</a></li><li><a class="tocitem" href="../../peptides/mutators/design/">Design Mutator</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-2-6" type="checkbox"/><label class="tocitem" for="menuitem-3-2-6"><span class="docs-label">Drivers</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../peptides/drivers/rotamer-blitz-driver/">Rotamer Blitz</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-2-7" type="checkbox"/><label class="tocitem" for="menuitem-3-2-7"><span class="docs-label">Submodules</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../peptides/submodules/selections/">Selections</a></li><li><a class="tocitem" href="../../peptides/submodules/builder/">Builder</a></li><li><a class="tocitem" href="../../peptides/submodules/rotamers/">Rotamers</a></li><li><a class="tocitem" href="../../peptides/submodules/external-packages/">External packages</a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-3" type="checkbox"/><label class="tocitem" for="menuitem-3-3"><span class="docs-label">Materials</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../materials/introduction/">Introduction</a></li><li><input class="collapse-toggle" id="menuitem-3-3-2" type="checkbox"/><label class="tocitem" for="menuitem-3-3-2"><span class="docs-label">Methods</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../materials/methods/lattices/">Lattices</a></li><li><a class="tocitem" href="../../materials/methods/carbons/">Carbons</a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-4" type="checkbox"/><label class="tocitem" for="menuitem-3-4"><span class="docs-label">Sugars</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../sugars/introduction/">Introduction</a></li><li><input class="collapse-toggle" id="menuitem-3-4-2" type="checkbox"/><label class="tocitem" for="menuitem-3-4-2"><span class="docs-label">Submodules</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../sugars/submodules/builder/">Builder</a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-5" type="checkbox"/><label class="tocitem" for="menuitem-3-5"><span class="docs-label">Common</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../common/introduction/">Introduction</a></li></ul></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">ProtoSyn API</a></li><li><a class="is-disabled">Core</a></li><li class="is-active"><a href>Types</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Types</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/sergio-santos-group/ProtoSyn.jl/blob/master/docs/src/protosyn-api/core/types.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="core-types"><a class="docs-heading-anchor" href="#core-types">Types</a><a id="core-types-1"></a><a class="docs-heading-anchor-permalink" href="#core-types" title="Permalink"></a></h1><p>In this section we will explore the main <code>struct</code> instances that compose the core of ProtoSyn&#39;s engine, divided in the following topics, for organization purposes:</p><ul><li><a href="#pose-types">Pose</a></li><li><a href="#fragment-types">Fragment</a></li><li><a href="#graph-types">Graph</a></li><li><a href="#state-types">State</a></li></ul><h2 id="pose-types"><a class="docs-heading-anchor" href="#pose-types">Pose</a><a id="pose-types-1"></a><a class="docs-heading-anchor-permalink" href="#pose-types" title="Permalink"></a></h2><p>A pose holds all necessary information regarding a molecular system. This information is divided in the <a href="#state-types">Graph</a> and <a href="#state-types">State</a> .</p><article class="docstring"><header><a class="docstring-binding" id="ProtoSyn.Pose" href="#ProtoSyn.Pose"><code>ProtoSyn.Pose</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">Pose{T &lt;: AbstractContainer}(graph::T, state::State)</code></pre><p>Return a Pose instance. A Pose is a complete description of a molecular system  at any given point, having both the interaction graph and the current state of the system coordinates represented. A <a href="#ProtoSyn.Pose"><code>Pose</code></a> is typed by an [AbstractContainer], usually a <a href="#ProtoSyn.Topology"><code>Topology</code></a>.</p><pre><code class="nohighlight hljs">Pose(::T, frag::Fragment) where {T &lt;: AbstractContainer}</code></pre><p>Return a <a href="#pose-types">Pose</a> instance from a <a href="#ProtoSyn.Fragment"><code>Fragment</code></a>, where the <a href="#state-types">State</a> is empty/blank. The graph contents are copied to the new <a href="#pose-types">Pose</a>. If no type <code>T &lt;: AbstractFloat</code> is provided, the <code>Units.defaultFloat</code> will be used.</p><p><strong>See also</strong></p><p><a href="#ProtoSyn.Fragment"><code>Fragment</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sergio-santos-group/ProtoSyn.jl/blob/b5a50a0f2a0a2e5b8a72028e911f825be1f05a72/src/Core/Types/pose.jl#L3-L19">source</a></section></article><h2 id="fragment-types"><a class="docs-heading-anchor" href="#fragment-types">Fragment</a><a id="fragment-types-1"></a><a class="docs-heading-anchor-permalink" href="#fragment-types" title="Permalink"></a></h2><p>ProtoSyn.jl package uses a pose of a single <a href="#ProtoSyn.Segment"><code>Segment</code></a> (therefore without a Root) to carry information during certain processes (such as building a new peptide from a sequence).</p><article class="docstring"><header><a class="docstring-binding" id="ProtoSyn.Fragment" href="#ProtoSyn.Fragment"><code>ProtoSyn.Fragment</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">Fragment</code></pre><p>A <a href="#ProtoSyn.Fragment"><code>Fragment</code></a> is a type overload for <code>Pose{Segment}</code> and therefore does not contain a root/origin. These are usually used as temporary carriers of information, without the ability to be directly incorporated in simulations.</p><p><strong>See also</strong></p><p><a href="../methods/pose/#ProtoSyn.fragment-Tuple{Pose{Topology}}"><code>fragment</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sergio-santos-group/ProtoSyn.jl/blob/b5a50a0f2a0a2e5b8a72028e911f825be1f05a72/src/Core/Types/pose.jl#L31-L41">source</a></section></article><h2 id="graph-types"><a class="docs-heading-anchor" href="#graph-types">Graph</a><a id="graph-types-1"></a><a class="docs-heading-anchor-permalink" href="#graph-types" title="Permalink"></a></h2><p>The directed graph holds the information regarding the hierarchical organization of a molecular system, where the top level of organization is a <a href="#ProtoSyn.Topology"><code>Topology</code></a> instance, which can contain one or more instances of <a href="#ProtoSyn.Segment"><code>Segment</code></a>. This structure, in turn, is comprised of one or more <a href="#ProtoSyn.Residue"><code>Residue</code></a> instances, which are themselves a set of <a href="#ProtoSyn.Atom"><code>Atom</code></a> instances, this being the lowest level of data organization in ProtoSyn. By being a directed graph, this data organization structure introduces the concept of parenthood between particles in the system: each <a href="#ProtoSyn.Atom"><code>Atom</code></a> has a parent, and may have one or more child <a href="#ProtoSyn.Atom"><code>Atom</code></a> instances. The same concept is extended to <a href="#ProtoSyn.Residue"><code>Residue</code></a> and <a href="#ProtoSyn.Segment"><code>Segment</code></a> instances. Ultimately, the initial <a href="#ProtoSyn.Atom"><code>Atom</code></a> in a <a href="#ProtoSyn.Pose"><code>Pose</code></a> is a child of the root structure, a group of three virtual atoms. The parenthood relationships not only allow for directed traveling of the graph, but also offer interesting opportunities when coupled with the hybrid coordinate system of the <a href="#ProtoSyn.Pose"><code>Pose</code></a>&#39;s <a href="#state-types">State</a>.</p><p><img src="../../../assets/ProtoSyn-graph1.png" alt="ProtoSyn graph"/></p><article class="docstring"><header><a class="docstring-binding" id="ProtoSyn.Topology" href="#ProtoSyn.Topology"><code>ProtoSyn.Topology</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">Topology &lt;: AbstractContainer{Segment}
Topology(name::String, id::Int)</code></pre><p>Construct a <a href="#ProtoSyn.Topology"><code>Topology</code></a>, with the given <code>name</code> and <code>id</code>. A <a href="#ProtoSyn.Topology"><code>Topology</code></a> is the top level of hierarchy in a Graph, and holds a <code>Root</code> <a href="#ProtoSyn.Residue"><code>Residue</code></a>, therefore initializing the internal coordinates system in the corresponding [State] of a <a href="#pose-types">Pose</a>.  <em>Note:</em> <a href="#ProtoSyn.Topology"><code>Topology</code></a> is of super type <code>AbstractTopology</code>, which is an <code>AbstractContainer</code>.</p><p><strong>Fields</strong></p><ul><li><code>name::String</code> - The name of the <a href="#ProtoSyn.Topology"><code>Topology</code></a></li><li><code>id::Int</code> - The ID of the <a href="#ProtoSyn.Topology"><code>Topology</code></a></li><li><code>items::Vector{Segment}</code> - All the <a href="#ProtoSyn.Segment"><code>Segment</code></a> instances in this <a href="#ProtoSyn.Topology"><code>Topology</code></a> (default: empty)</li><li><code>size::Int</code> - The number of <a href="#ProtoSyn.Segment"><code>Segment</code></a> instances in this <a href="#ProtoSyn.Topology"><code>Topology</code></a> (default: 0)</li><li><code>root::Residue</code> - The root <a href="#ProtoSyn.Residue"><code>Residue</code></a> of this <a href="#ProtoSyn.Topology"><code>Topology</code></a></li><li><code>container::Nothing</code> - Used to identify the root <a href="#ProtoSyn.Residue"><code>Residue</code></a>  (default: <code>nothing</code>)</li></ul><div class="admonition is-category-ukw"><header class="admonition-header">Note:</header><div class="admonition-body"><p>When in a <a href="#pose-types">Pose</a>, both the <a href="#ProtoSyn.Topology"><code>Topology</code></a> and the corresponding <a href="#state-types">State</a> need to share the same <code>:id</code>. This is used to identify situations where a change in one of this structures was not reflected on the other.</p></div></div><p><strong>See also</strong></p><p><a href="../methods/graph/#ProtoSyn.root"><code>root</code></a> <a href="#ProtoSyn.Segment"><code>Segment</code></a></p><p><strong>Examples</strong></p><pre><code class="language-julia-repl hljs">julia&gt; top = Topology(&quot;UNK&quot;, 1)
Topology{/UNK:1}</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sergio-santos-group/ProtoSyn.jl/blob/b5a50a0f2a0a2e5b8a72028e911f825be1f05a72/src/Core/Types/graph.jl#L175-L208">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ProtoSyn.Segment" href="#ProtoSyn.Segment"><code>ProtoSyn.Segment</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">Segment &lt;: AbstractContainer{Residue}
Segment(name::String, id::Int)</code></pre><p>Construct a <a href="#ProtoSyn.Segment"><code>Segment</code></a>, with the given <code>name</code> and <code>id</code>. The created segment has no container. A <a href="#ProtoSyn.Segment"><code>Segment</code></a> is a group of <a href="#ProtoSyn.Residue"><code>Residue</code></a> instances. <em>Note:</em> <a href="#ProtoSyn.Segment"><code>Segment</code></a> is of super type <code>AbstractSegment</code>, which is an <code>AbstractContainer</code>.</p><p><strong>Fields</strong></p><ul><li><code>name::String</code> - The name of the <a href="#ProtoSyn.Segment"><code>Segment</code></a></li><li><code>id::Int</code> - The ID of the <a href="#ProtoSyn.Segment"><code>Segment</code></a></li><li><code>index::Int</code> - The index of the <a href="#ProtoSyn.Segment"><code>Segment</code></a> (default: same as <code>:id</code>)</li><li><code>code::Char</code> - A 1-letter code for the chain (used in PDB formatting) (default: &#39;?&#39;)</li><li><code>items::Vector{Residue}</code> - A list of <a href="#ProtoSyn.Residue"><code>Residue</code></a> instances in this <a href="#ProtoSyn.Segment"><code>Segment</code></a> (default: empty)</li><li><code>container::Opt{AbstractTopology}</code> - An optional container for this <a href="#ProtoSyn.Segment"><code>Segment</code></a> (default: <code>nothing</code>)</li><li><code>size::Int</code> - The number of <a href="#ProtoSyn.Residue"><code>Residue</code></a> instances in this <a href="#ProtoSyn.Segment"><code>Segment</code></a> (default: 0)</li></ul><p><strong>See also</strong></p><p><a href="#ProtoSyn.Topology"><code>Topology</code></a> <a href="#ProtoSyn.Residue"><code>Residue</code></a></p><p><strong>Examples</strong></p><pre><code class="language-julia-repl hljs">julia&gt; res = Segment(&quot;UNK&quot;, 1)
Segment{/UNK:1}</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sergio-santos-group/ProtoSyn.jl/blob/b5a50a0f2a0a2e5b8a72028e911f825be1f05a72/src/Core/Types/graph.jl#L133-L159">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ProtoSyn.Residue" href="#ProtoSyn.Residue"><code>ProtoSyn.Residue</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">Residue &lt;: AbstractContainer{Atom}
Residue(name::String, id::Int)</code></pre><p>Construct a <a href="#ProtoSyn.Residue"><code>Residue</code></a>, with the given <code>name</code> and <code>id</code>. The created residue has no container; it is also a free directed-graph node (no parent/children). A <a href="#ProtoSyn.Residue"><code>Residue</code></a> is a group of <a href="#ProtoSyn.Atom"><code>Atom</code></a> instances. <em>Note:</em> <a href="#ProtoSyn.Residue"><code>Residue</code></a> is of super type <code>AbstractResidue</code>, which is an <code>AbstractContainer</code>.</p><p><strong>Fields</strong></p><ul><li><code>name::ResidueName</code> - The name of the <a href="#ProtoSyn.Residue"><code>Residue</code></a></li><li><code>id::Int</code> - The ID of the <a href="#ProtoSyn.Residue"><code>Residue</code></a></li><li><code>index::Int</code> - The index of the <a href="#ProtoSyn.Residue"><code>Residue</code></a> (default: same as <code>:id</code>)</li><li><code>items::Vector{Atom}</code> - A list of <a href="#ProtoSyn.Atom"><code>Atom</code></a> instances in this <a href="#ProtoSyn.Residue"><code>Residue</code></a> (default: empty)</li><li><code>itemsbyname::Dict{String, Atom}</code> - A <code>Dict</code> object containing a link to each of the <a href="#ProtoSyn.Atom"><code>Atom</code></a> instances in this <a href="#ProtoSyn.Residue"><code>Residue</code></a> bsed on the <code>:name</code> of the <a href="#ProtoSyn.Atom"><code>Atom</code></a> (default: empty)</li><li><code>container::Opt{AbstractSegment}</code> - An optional container for this <a href="#ProtoSyn.Residue"><code>Residue</code></a> (default: <code>nothing</code>)</li><li><code>size::Int</code> - The number of <a href="#ProtoSyn.Atom"><code>Atom</code></a> instances in this <a href="#ProtoSyn.Residue"><code>Residue</code></a> (default: 0)</li><li><code>visited::Bool</code> - Check whether this <a href="#ProtoSyn.Residue"><code>Residue</code></a> has been visited (used by a some functions) (default: <code>false</code>)</li><li><code>parent::Opt{Residue}</code> - Optionally, the parent of this <a href="#ProtoSyn.Residue"><code>Residue</code></a> in the directional graph (default: <code>nothing</code>)</li><li><code>children::Vector{Residue}</code> - Optionally, the list of children <a href="#ProtoSyn.Residue"><code>Residue</code></a> instances downstream of this <a href="#ProtoSyn.Residue"><code>Residue</code></a> (default: empty)</li><li><code>ascedents::Opt{NTuple{4, Int}}</code> - Optionally, the list of 4 <a href="../methods/graph/#ProtoSyn.ascendents"><code>ascendents</code></a>, including this <a href="#ProtoSyn.Residue"><code>Residue</code></a> (default: <code>nothing</code>)</li></ul><p><strong>See also</strong></p><p><a href="#ProtoSyn.Segment"><code>Segment</code></a> <a href="#ProtoSyn.Atom"><code>Atom</code></a> <a href="../methods/graph/#ProtoSyn.ascendents"><code>ascendents</code></a> <a href="#ProtoSyn.ResidueName"><code>ResidueName</code></a></p><p><strong>Examples</strong></p><pre><code class="language-julia-repl hljs">julia&gt; res = Residue(&quot;UNK&quot;, 1)
Residue{/UNK:1}</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sergio-santos-group/ProtoSyn.jl/blob/b5a50a0f2a0a2e5b8a72028e911f825be1f05a72/src/Core/Types/graph.jl#L79-L110">source</a></section></article><div class="admonition is-category-ukw"><header class="admonition-header">Note:</header><div class="admonition-body"><p>Instead of defining <a href="#ProtoSyn.Residue"><code>Residue</code></a>.name as a String, ProtoSyn uses a specific type (<a href="#ProtoSyn.ResidueName"><code>ResidueName</code></a>) to accomodate specific conventions in aminoacid naming.</p></div></div><article class="docstring"><header><a class="docstring-binding" id="ProtoSyn.ResidueName" href="#ProtoSyn.ResidueName"><code>ProtoSyn.ResidueName</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">ResidueName(s::String) &lt;: AbstractString</code></pre><p>A string overload to accomodate different known and expected denominations of certain residues (&quot;HIS&quot; == &quot;HIE&quot; for example).</p><p><strong>Example</strong></p><pre><code class="nohighlight hljs">julia&gt; ProtoSyn.ResidueName(&quot;HIS&quot;)
HIS</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sergio-santos-group/ProtoSyn.jl/blob/b5a50a0f2a0a2e5b8a72028e911f825be1f05a72/src/Core/Types/other.jl#L1-L12">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ProtoSyn.Atom" href="#ProtoSyn.Atom"><code>ProtoSyn.Atom</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">Atom &lt;: AbstractContainer{Nothing}</code></pre><p>An <code>Atom</code> type.</p><pre><code class="nohighlight hljs">Atom(name::String, id::Int, index::Int, symbol::String)</code></pre><p>Construct an <code>Atom</code>, with the given <code>name</code>, <code>id</code>, <code>index</code>, and <code>symbol</code>. The created atom has no bonds and container; it is also a free directed-graph node (no parent/children). <em>Note:</em> <a href="#ProtoSyn.Atom"><code>Atom</code></a> is of super type <code>AbstractAtom</code>, which is an <code>AbstractContainer</code>.</p><p><strong>Fields</strong></p><ul><li><code>name::String</code> - The name of the <a href="#ProtoSyn.Atom"><code>Atom</code></a></li><li><code>id::Int</code> - The ID of the <a href="#ProtoSyn.Atom"><code>Atom</code></a></li><li><code>index::Int</code> - The index of the <a href="#ProtoSyn.Atom"><code>Atom</code></a> (default: same as <code>:id</code>)</li><li><code>symbol::String</code> - The chemical element symbol of this <a href="#ProtoSyn.Atom"><code>Atom</code></a></li><li><code>bonds::Vector{Atom}</code> - A list of <a href="#ProtoSyn.Atom"><code>Atom</code></a> instances connected to this <a href="#ProtoSyn.Atom"><code>Atom</code></a> by a bond (default: empty)</li><li><code>container::Opt{AbstractResidue}</code> - An optional container for this <a href="#ProtoSyn.Atom"><code>Atom</code></a> (default: <code>nothing</code>)</li><li><code>visited::Bool</code> - Check whether this <a href="#ProtoSyn.Atom"><code>Atom</code></a> has been visited (used by a some functions) (default: <code>false</code>)</li><li><code>parent::Opt{Atom}</code> - Optionally, the parent of this <a href="#ProtoSyn.Atom"><code>Atom</code></a> in the directional graph (default: <code>nothing</code>)</li><li><code>children::Vector{Atom}</code> - Optionally, the list of children <a href="#ProtoSyn.Atom"><code>Atom</code></a> instances downstream of this <a href="#ProtoSyn.Atom"><code>Atom</code></a> (default: empty)</li><li><code>ascedents::Opt{NTuple{4, Int}}</code> - Optionally, the list of 4 ascendents, including this <a href="#ProtoSyn.Atom"><code>Atom</code></a> (default: <code>nothing</code>)</li></ul><p><strong>See also</strong></p><p><a href="#ProtoSyn.Residue"><code>Residue</code></a> [ascendents]</p><p><strong>Examples</strong></p><pre><code class="language-julia-repl hljs">julia&gt; at = Atom(&quot;H1&quot;, 1, 1, &quot;H&quot;)
Atom{/H1:1}</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sergio-santos-group/ProtoSyn.jl/blob/b5a50a0f2a0a2e5b8a72028e911f825be1f05a72/src/Core/Types/graph.jl#L25-L57">source</a></section></article><h2 id="state-types"><a class="docs-heading-anchor" href="#state-types">State</a><a id="state-types-1"></a><a class="docs-heading-anchor-permalink" href="#state-types" title="Permalink"></a></h2><p>A <a href="#state-types">State</a> structure is responsible for holding the current <em>state</em> of the internal and cartesian coordinates, as well as the forces felt on each atom and the resulting energy of the system (as calculated by an [EnergyFunction]). This structure is sub-divided in a list of <a href="#ProtoSyn.AtomState"><code>AtomState</code></a> instances and a <a href="#ProtoSyn.StateMatrix"><code>StateMatrix</code></a>. Both of these structures are complementary, meaning that any change in one in synched in the other. While <a href="#ProtoSyn.AtomState"><code>AtomState</code></a> instances hold both the internal and cartesian coordinates relative to a single <a href="#ProtoSyn.Atom"><code>Atom</code></a>, <a href="#ProtoSyn.StateMatrix"><code>StateMatrix</code></a> is a 2D matrix of all cartesian coordinates of the atoms in a given <a href="#pose-types">Pose</a>.</p><article class="docstring"><header><a class="docstring-binding" id="ProtoSyn.State" href="#ProtoSyn.State"><code>ProtoSyn.State</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">State([::T]) where {T &lt;: AbstractFloat}</code></pre><p>A <code>State</code> is a complete representation of a given molecular system regarding the position, the forces felt and the resulting energetic contribution by each atom. Each <a href="#ProtoSyn.AtomState"><code>AtomState</code></a> in a system.</p><pre><code class="nohighlight hljs">State([::T], n::Int) where {T &lt;: AbstractFloat}</code></pre><p>Return a <a href="#ProtoSyn.State"><code>State</code></a> with size <code>n</code>, with all <code>items</code> set to be an empty <a href="#ProtoSyn.AtomState"><code>AtomState</code></a>.</p><pre><code class="nohighlight hljs">State([::T], items::Vector{AtomState{T}}) where {T &lt;: AbstractFloat}</code></pre><p>Return a <a href="#ProtoSyn.State"><code>State</code></a> with size <code>length(items)</code>, with all the given <code>items</code>.</p><div class="admonition is-category-ukw"><header class="admonition-header">Note:</header><div class="admonition-body"><p>If no type <code>T &lt;: AbstractFloat</code> is provided, <code>Units.defaultFloat</code> will be used.</p></div></div><p><strong>Fields</strong></p><ul><li><code>items::Vector{AtomState{T}}</code> - The list of <a href="#ProtoSyn.AtomState"><code>AtomState</code></a> instances in this <a href="#ProtoSyn.State"><code>State</code></a> (default: empty)</li><li><code>size::Int</code> - The number of <a href="#ProtoSyn.AtomState"><code>AtomState</code></a> instances in this <a href="#ProtoSyn.State"><code>State</code></a> (default: 0)</li><li><code>id::Int</code> - The Id (to be matched to the corresponding <a href="#ProtoSyn.Topology"><code>Topology</code></a> in a <a href="#ProtoSyn.Pose"><code>Pose</code></a>) (default: -1)</li><li><code>i2c::Bool</code> - Flag indicating this <a href="#ProtoSyn.State"><code>State</code></a> needs to be synched to cartesian coordinates (default: false)</li><li><code>c2i::Bool</code> - Flag indicating this <a href="#ProtoSyn.State"><code>State</code></a> needs to be synched to internal coordinates (default: false)</li><li><code>index_offset::Int</code> - Ignore the first <em>N</em> <a href="#ProtoSyn.AtomState"><code>AtomState</code></a> instances (default: 3)</li><li><code>x::StateMatrix{T}</code> - The cartesian coordinate matrix of all <a href="#ProtoSyn.AtomState"><code>AtomState</code></a> instances in this <a href="#ProtoSyn.State"><code>State</code></a> (default: empty)</li><li><code>f::Matrix{T}</code> - The force matrix of all <a href="#ProtoSyn.AtomState"><code>AtomState</code></a> instances in this <a href="#ProtoSyn.State"><code>State</code></a> (default: empty)</li><li><code>e::Dict{Symbol, T}</code> - The list of all energetic components evaluated for this <a href="#ProtoSyn.State"><code>State</code></a> (default: empty)</li></ul><p><strong>See also</strong></p><p><a href="#ProtoSyn.Topology"><code>Topology</code></a> <a href="#ProtoSyn.AtomState"><code>AtomState</code></a> <a href="#ProtoSyn.StateMatrix"><code>StateMatrix</code></a></p><p><strong>Examples</strong></p><pre><code class="language-julia-repl hljs">julia&gt; State(4)
State{Float64}:
 Size: 4
 i2c: false | c2i: false
 Energy: Dict(:Total =&gt; Inf)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sergio-santos-group/ProtoSyn.jl/blob/b5a50a0f2a0a2e5b8a72028e911f825be1f05a72/src/Core/Types/state.jl#L228-L269">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ProtoSyn.AtomState" href="#ProtoSyn.AtomState"><code>ProtoSyn.AtomState</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">AtomState{T}(parent::Any, index::Int, t::MVector{3, T}, r::MMatrix{3, 3, T, 9}, b::T, θ::T, ϕ::T, δ::T, Δϕ::T, changed::Bool) where {T &lt;: AbstractFloat}</code></pre><p>An <a href="#ProtoSyn.AtomState"><code>AtomState</code></a> instance. Holds information regarding the state of the atom, including the cartesian and internal coordinates.</p><pre><code class="nohighlight hljs">AtomState([::T]) where {T &lt;: AbstractFloat}</code></pre><p>Return an empty <a href="#ProtoSyn.AtomState"><code>AtomState</code></a> instance, with all default values.</p><div class="admonition is-category-ukw"><header class="admonition-header">Note:</header><div class="admonition-body"><p>If no type <code>T &lt;: AbstractFloat</code> is provided, <code>Units.defaultFloat</code> will be used.</p></div></div><div class="admonition is-category-ukw"><header class="admonition-header">Note:</header><div class="admonition-body"><p>Changing this <a href="#ProtoSyn.AtomState"><code>AtomState</code></a> cartesian coordinates will update and sync changes with a sibling <a href="#ProtoSyn.StateMatrix"><code>StateMatrix</code></a>, as long as this structs <code>parent</code> is correctly set.</p></div></div><p><strong>Fields</strong></p><ul><li><code>parent::Any</code> - If set, should point to the parent <a href="#ProtoSyn.State"><code>State</code></a> containing this <a href="#ProtoSyn.AtomState"><code>AtomState</code></a> (default: nothing)</li><li><code>index::Int</code> - the index of this <a href="#ProtoSyn.AtomState"><code>AtomState</code></a></li><li><code>t::MVector{3, T}</code> - The translation vector from origin (cartesian coordinates) (default: empty)</li><li><code>r::MMatrix{3, 3, T, 9}</code> - The rotation matrix for cartesian to internal coordinate sync (default: empty)</li><li><code>b::T</code> - Distance (in Angstrom Å) to parent atom (default: 0)</li><li><code>θ::T</code> - Angle (in radians) to ascendent atoms (default: 0)</li><li><code>ϕ::T</code> - Dihedral angle (in radians) to ascendent atoms (default: 0)</li><li><code>δ::T</code> - Atomic partial charge (default: 0.0)</li><li><code>Δϕ::T</code> - Dihedral angle change (in radians) to be applied to children atoms (default: 0)</li><li><code>changed::Bool</code> - Flag indicating whether this <a href="#ProtoSyn.AtomState"><code>AtomState</code></a> has been modified (useful in some functions such as <a href="../methods/state/#ProtoSyn.i2c!"><code>i2c!</code></a> and <a href="../methods/state/#ProtoSyn.c2i!"><code>c2i!</code></a>) (default: false)</li></ul><div class="admonition is-category-ukw"><header class="admonition-header">Note:</header><div class="admonition-body"><p>The <code>Δϕ</code> field in <a href="#ProtoSyn.AtomState"><code>AtomState</code></a> allows for easy set-up of dihedral angles in molecular structures. By modifying <code>Δϕ</code> in an atom, all child atoms will be rotated by the same amount, even in being branched structures.</p></div></div><p><strong>See also</strong></p><p><a href="#ProtoSyn.State"><code>State</code></a> <a href="#ProtoSyn.StateMatrix"><code>StateMatrix</code></a></p><p><strong>Examples</strong></p><pre><code class="language-julia-repl hljs">julia&gt; AtomState()
AtomState{Float64}:
 Index: -1
 T: [0.000, 0.000, 0.000]
 b: 0.000 Å | θ:  0.000 rad (   0.00°) | ϕ:  0.000 rad (   0.00°) | Δϕ:  0.000 rad (   0.00°)
 δ: 0.000
 Changed: false</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sergio-santos-group/ProtoSyn.jl/blob/b5a50a0f2a0a2e5b8a72028e911f825be1f05a72/src/Core/Types/state.jl#L9-L56">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ProtoSyn.StateMatrix" href="#ProtoSyn.StateMatrix"><code>ProtoSyn.StateMatrix</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">StateMatrix{T}(parent::Any, coords::Matrix{T}) where {T &lt;: AbstractFloat}</code></pre><p>A <a href="#ProtoSyn.StateMatrix"><code>StateMatrix</code></a> instance holds the cartesian coordinates of all <a href="#ProtoSyn.AtomState"><code>AtomState</code></a> instances in a <a href="#ProtoSyn.State"><code>State</code></a>. It is an overload of a <code>Matrix</code> struct, and used to efficiently apply substantial changes to a system or a large number of atoms. </p><div class="admonition is-category-ukw"><header class="admonition-header">Note:</header><div class="admonition-body"><p>If no type <code>T &lt;: AbstractFloat</code> is provided, <code>Units.defaultFloat</code> will be used.</p></div></div><div class="admonition is-category-ukw"><header class="admonition-header">Note:</header><div class="admonition-body"><p>Changing this <a href="#ProtoSyn.StateMatrix"><code>StateMatrix</code></a> cartesian coordinates will update and sync changes with a sibling <a href="#ProtoSyn.AtomState"><code>AtomState</code></a>, as long as this structs <code>parent</code> is correctly set. In such case, the <code>parent.c2i</code> flag is also set to <code>true</code>.</p></div></div><p><strong>Fields</strong></p><ul><li><code>parent::Any</code> - If set, should point to the parent <a href="#ProtoSyn.State"><code>State</code></a> containing this <a href="#ProtoSyn.StateMatrix"><code>StateMatrix</code></a> (default: nothing)</li><li><code>coords::Matrix</code> - The cartesian coordinates matrix</li></ul><p><strong>See also</strong></p><p><a href="#ProtoSyn.State"><code>State</code></a> <a href="#ProtoSyn.AtomState"><code>AtomState</code></a></p><p><strong>Examples</strong></p><pre><code class="language-julia-repl hljs">julia&gt; StateMatrix(zeros(3, 3))
StateMatrix{Float64}:
 Parent set: false
3×3 Matrix{Float64}:
 0.0  0.0  0.0
 0.0  0.0  0.0
 0.0  0.0  0.0</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sergio-santos-group/ProtoSyn.jl/blob/b5a50a0f2a0a2e5b8a72028e911f825be1f05a72/src/Core/Types/state.jl#L128-L163">source</a></section></article><h3 id="Array-of-Structures-vs-Structure-of-Arrays"><a class="docs-heading-anchor" href="#Array-of-Structures-vs-Structure-of-Arrays">Array of Structures vs Structure of Arrays</a><a id="Array-of-Structures-vs-Structure-of-Arrays-1"></a><a class="docs-heading-anchor-permalink" href="#Array-of-Structures-vs-Structure-of-Arrays" title="Permalink"></a></h3><p>Given this organization of cartesian coordinates in a <a href="#pose-types">Pose</a>, a decades old dilemma naturally emerges: should the data be organized in Array of Structures or in a Structure of Arrays. The differences are illustrated bellow:</p><ul><li>Structure of Arrays (SoA) - The main object is a single structure which holds a vector for each of the coordinates of all <a href="#ProtoSyn.Atom"><code>Atom</code></a> instances. Each coordinate vector of all <a href="#ProtoSyn.Atom"><code>Atom</code></a> instances is contiguous in memory.</li><li>Array of Structures (AoS) - The main object is a vector of <a href="#ProtoSyn.Atom"><code>Atom</code></a> instances, where each <a href="#ProtoSyn.Atom"><code>Atom</code></a> structure holds a field for each coordinate. Each <a href="#ProtoSyn.Atom"><code>Atom</code></a> set of coordinates is contiguous in memory.</li></ul><p><img src="../../../assets/ProtoSyn-aos-vs-soa.png" alt="ProtoSyn Energy Function"/></p><p><strong>Figure 1 |</strong> Visualization of <a href="#ProtoSyn.Atom"><code>Atom</code></a> instances organization in memory: Structure of Arrays (SoA) vs Array of Structures (AoS). In one hand, when employing the Structure of Arrays (SoA) paradigm, memory is contiguous when accessing all the X coordinates of each <a href="#ProtoSyn.Atom"><code>Atom</code></a> instance (for example). On the other hand, when employing the Array of Structures (AoS) paradigm, memory is contiguous when accessing all the X, Y and Z coordinates of a single atom (or adjacently indexed atoms).</p><p>Given that Julia is a <a href="https://docs.julialang.org/en/v1/manual/performance-tips/#man-performance-column-major">column major programming language</a> and based on performance benchmarks during early development cycles, ProtoSyn is developed using the <strong>Array of Structures (AoS)</strong> paradigm (each <a href="#ProtoSyn.State"><code>State</code></a> contains an array of structures <a href="#ProtoSyn.AtomState"><code>AtomState</code></a>).</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../../getting-started/examples/">« Examples</a><a class="docs-footer-nextpage" href="../methods/graph/">Graph »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.19 on <span class="colophon-date" title="Monday 4 July 2022 16:15">Monday 4 July 2022</span>. Using Julia version 1.7.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
