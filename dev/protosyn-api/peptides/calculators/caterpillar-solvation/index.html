<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Caterpilar solvation model ¬∑ ProtoSyn.jl</title><script data-outdated-warner src="../../../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.044/juliamono.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../../assets/documenter.js"></script><script src="../../../../siteinfo.js"></script><script src="../../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../../assets/themeswap.js"></script><link href="../../../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../../../"><img src="../../../../assets/logo.png" alt="ProtoSyn.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../../../">ProtoSyn.jl</a></span></div><form class="docs-search" action="../../../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../../../">Home</a></li><li><span class="tocitem">Getting Started</span><ul><li><a class="tocitem" href="../../../../getting-started/installation/">Installation</a></li><li><a class="tocitem" href="../../../../getting-started/first-steps/">First steps</a></li><li><a class="tocitem" href="../../../../getting-started/examples/">Examples</a></li></ul></li><li><span class="tocitem">ProtoSyn API</span><ul><li><input class="collapse-toggle" id="menuitem-3-1" type="checkbox"/><label class="tocitem" for="menuitem-3-1"><span class="docs-label">Core</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../core/types/">Types</a></li><li><input class="collapse-toggle" id="menuitem-3-1-2" type="checkbox"/><label class="tocitem" for="menuitem-3-1-2"><span class="docs-label">Methods</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../core/methods/graph/">Graph</a></li><li><a class="tocitem" href="../../../core/methods/state/">State</a></li><li><a class="tocitem" href="../../../core/methods/pose/">Pose</a></li><li><a class="tocitem" href="../../../core/methods/io/">Input and Output (IO)</a></li><li><a class="tocitem" href="../../../core/methods/other/">Auxiliary methods</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-1-3" type="checkbox"/><label class="tocitem" for="menuitem-3-1-3"><span class="docs-label">Calculators</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../core/calculators/calculators-section/">Calculators Section</a></li><li><a class="tocitem" href="../../../core/calculators/torchani/">TorchANI</a></li><li><a class="tocitem" href="../../../core/calculators/bond-distance-restraint/">Bond distance Restraint</a></li><li><a class="tocitem" href="../../../core/calculators/potential-restraints/">Potential Restraints</a></li><li><a class="tocitem" href="../../../core/calculators/electrostatics/">Electrostatics</a></li><li><a class="tocitem" href="../../../core/calculators/gb-solvation/">Generalized Born</a></li><li><a class="tocitem" href="../../../core/calculators/sasa/">SASA</a></li><li><a class="tocitem" href="../../../core/calculators/hydrogen-bonds/">Hydrogen Bonds</a></li><li><a class="tocitem" href="../../../core/calculators/radius-gyration/">Radius of gyration</a></li><li><a class="tocitem" href="../../../core/calculators/custom-ref-energy/">Custom reference energy</a></li><li><a class="tocitem" href="../../../core/calculators/ref15/">REF-15</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-1-4" type="checkbox"/><label class="tocitem" for="menuitem-3-1-4"><span class="docs-label">Mutators</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../core/mutators/mutators-section/">Mutators Section</a></li><li><a class="tocitem" href="../../../core/mutators/mutators-dihedral/">Dihedral Mutator</a></li><li><a class="tocitem" href="../../../core/mutators/mutators-crankshaft/">Crankshaft Mutator</a></li><li><a class="tocitem" href="../../../core/mutators/mutators-rigid-body/">Rigid Body Mutators</a></li><li><a class="tocitem" href="../../../core/mutators/mutators-backrub/">Backrub Mutators</a></li><li><a class="tocitem" href="../../../core/mutators/mutators-compound/">Compound Mutators</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-1-5" type="checkbox"/><label class="tocitem" for="menuitem-3-1-5"><span class="docs-label">Drivers</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../core/drivers/drivers-section/">Drivers Section</a></li><li><a class="tocitem" href="../../../core/drivers/drivers-monte-carlo/">Monte Carlo</a></li><li><a class="tocitem" href="../../../core/drivers/drivers-steepest-descent/">Steepest Descent</a></li><li><a class="tocitem" href="../../../core/drivers/drivers-ils/">ILS</a></li><li><a class="tocitem" href="../../../core/drivers/drivers-compound/">Compound Driver</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-1-6" type="checkbox"/><label class="tocitem" for="menuitem-3-1-6"><span class="docs-label">Submodules</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../core/submodules/selections/">Selections</a></li><li><a class="tocitem" href="../../../core/submodules/builder/">Builder</a></li><li><a class="tocitem" href="../../../core/submodules/external-packages/">External packages</a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-2" type="checkbox" checked/><label class="tocitem" for="menuitem-3-2"><span class="docs-label">Peptides</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../introduction/">Introduction</a></li><li><a class="tocitem" href="../../types/">Types</a></li><li><input class="collapse-toggle" id="menuitem-3-2-3" type="checkbox"/><label class="tocitem" for="menuitem-3-2-3"><span class="docs-label">Methods</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../methods/io/">Input and Output (IO)</a></li><li><a class="tocitem" href="../../methods/graph/">Graph</a></li><li><a class="tocitem" href="../../methods/state/">State</a></li><li><a class="tocitem" href="../../methods/pose/">Pose</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-2-4" type="checkbox" checked/><label class="tocitem" for="menuitem-3-2-4"><span class="docs-label">Calculators</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../potential-restraints/">Potential Restraints</a></li><li><a class="tocitem" href="../electrostatics/">Electrostatics</a></li><li><a class="tocitem" href="../sasa/">SASA</a></li><li><a class="tocitem" href="../natural-frequency/">Natural frequency</a></li><li><a class="tocitem" href="../ss-propensity/">Secondary structure propensity</a></li><li class="is-active"><a class="tocitem" href>Caterpilar solvation model</a><ul class="internal"><li><a class="tocitem" href="#.-Burial-degree-calculation"><span>1. Burial degree calculation</span></a></li><li><a class="tocitem" href="#.-Hydrophobicity-weight-calculation"><span>2. Hydrophobicity weight calculation</span></a></li></ul></li><li><a class="tocitem" href="../seqdes/">SeqDes model</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-2-5" type="checkbox"/><label class="tocitem" for="menuitem-3-2-5"><span class="docs-label">Mutators</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../mutators/rotamer/">Rotamer Mutator</a></li><li><a class="tocitem" href="../../mutators/design/">Design Mutator</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-2-6" type="checkbox"/><label class="tocitem" for="menuitem-3-2-6"><span class="docs-label">Drivers</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../drivers/rotamer-blitz-driver/">Rotamer Blitz</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-2-7" type="checkbox"/><label class="tocitem" for="menuitem-3-2-7"><span class="docs-label">Submodules</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../submodules/selections/">Selections</a></li><li><a class="tocitem" href="../../submodules/builder/">Builder</a></li><li><a class="tocitem" href="../../submodules/rotamers/">Rotamers</a></li><li><a class="tocitem" href="../../submodules/external-packages/">External packages</a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-3" type="checkbox"/><label class="tocitem" for="menuitem-3-3"><span class="docs-label">Materials</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../materials/introduction/">Introduction</a></li><li><input class="collapse-toggle" id="menuitem-3-3-2" type="checkbox"/><label class="tocitem" for="menuitem-3-3-2"><span class="docs-label">Methods</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../materials/methods/lattices/">Lattices</a></li><li><a class="tocitem" href="../../../materials/methods/carbons/">Carbons</a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-4" type="checkbox"/><label class="tocitem" for="menuitem-3-4"><span class="docs-label">Sugars</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../sugars/introduction/">Introduction</a></li><li><input class="collapse-toggle" id="menuitem-3-4-2" type="checkbox"/><label class="tocitem" for="menuitem-3-4-2"><span class="docs-label">Submodules</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../sugars/submodules/builder/">Builder</a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-5" type="checkbox"/><label class="tocitem" for="menuitem-3-5"><span class="docs-label">Common</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../common/introduction/">Introduction</a></li></ul></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">ProtoSyn API</a></li><li><a class="is-disabled">Peptides</a></li><li><a class="is-disabled">Calculators</a></li><li class="is-active"><a href>Caterpilar solvation model</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Caterpilar solvation model</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/sergio-santos-group/ProtoSyn.jl/blob/master/docs/src/protosyn-api/peptides/calculators/caterpillar-solvation.md" title="Edit on GitHub"><span class="docs-icon fab">ÔÇõ</span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Caterpillar-Solvation"><a class="docs-heading-anchor" href="#Caterpillar-Solvation">Caterpillar Solvation</a><a id="Caterpillar-Solvation-1"></a><a class="docs-heading-anchor-permalink" href="#Caterpillar-Solvation" title="Permalink"></a></h1><p>The <a href="#Caterpillar-Solvation">Caterpillar Solvation</a> energy is a coarse-grained approximation to a solvation energy contribution, introducing a penalty for the exposure of hydrophobic <a href="../../../core/types/#ProtoSyn.Residue"><code>Residue</code></a> instances and a penalty for the burial of hydrophylic <a href="../../../core/types/#ProtoSyn.Residue"><code>Residue</code></a> instances (and vice-versa). </p><p>The Caterpillar solvation energy calculation is based on the work of Coluzza et al (see <a href="https://journals.plos.org/plosone/article?id=10.1371/journal.pone.0020853">this paper</a>).</p><p>The ProtoSyn&#39;s modifications introduce a significant degree of complexity, futher explained bellow. In sum, the calculation takes 2 steps: the <a href="#.-Burial-degree-calculation">1. Burial degree calculation</a> and the <a href="#.-Hydrophobicity-weight-calculation">2. Hydrophobicity weight calculation</a>.</p><h2 id=".-Burial-degree-calculation"><a class="docs-heading-anchor" href="#.-Burial-degree-calculation">1. Burial degree calculation</a><a id=".-Burial-degree-calculation-1"></a><a class="docs-heading-anchor-permalink" href="#.-Burial-degree-calculation" title="Permalink"></a></h2><p>In this step, a given algorithm loops over all the residues (selecting a given atom for distance matrix calculation) and identifies the burial degree of each residue (this step can be parametrized by (1) the burial degree algorithm, (2) the identification curve, (3) the selection atom, (4) the rmax cut-off and (5) slope control sc. These settings are further explained bellow).</p><h3 id=".1-Burial-degree-algorithm"><a class="docs-heading-anchor" href="#.1-Burial-degree-algorithm">1.1 Burial degree algorithm</a><a id=".1-Burial-degree-algorithm-1"></a><a class="docs-heading-anchor-permalink" href="#.1-Burial-degree-algorithm" title="Permalink"></a></h3><p>ProtoSyn offers 2 different burial degree identification algorithms, the Neighbour Count (NC) and Neighbour Vector (NV) (as explained further in <a href="https://pubmed.ncbi.nlm.nih.gov/19234730/">this paper</a>). In comparison to eachother, NC algorithms only take into consideration the number of selected atoms within a defined <code>rmax</code> range, while NV algorithms also take into consideration the orientation of neighbouring residues to defined the burial degree. As such, in general, NV algorithms are more precise, while carrying an additional performance weight.</p><article class="docstring"><header><a class="docstring-binding" id="ProtoSyn.Peptides.Calculators.Caterpillar.neighbour_count" href="#ProtoSyn.Peptides.Calculators.Caterpillar.neighbour_count"><code>ProtoSyn.Peptides.Calculators.Caterpillar.neighbour_count</code></a> ‚Äî <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">ProtoSyn.Peptides.Calculators.Caterpillar.neighbour_count([::A], pose::Pose, selection::Opt{AbstractSelection}, [update_forces::Bool = false]; [identification_curve::Function = null_identification_curve], [hydrophobicity_weight::Function = null_hydrophobicity_weight], [rmax::T = 9.0], [sc::T = 1.0], [Œ©::Union{Int, T} = 750.0], [hydrophobicity_map::Dict{String, T} = ProtoSyn.Peptides.doolitle_hydrophobicity]) where {A, T &lt;: AbstractFloat}</code></pre><p>Calculate the given <a href="../../../core/types/#ProtoSyn.Pose"><code>Pose</code></a> <code>pose</code> caterpillar solvation energy using the Neighbour Count (NC) algorithm (see <a href="https://journals.plos.org/plosone/article?id=10.1371/journal.pone.0020853">this article</a>). If an <code>AbstractSelection</code> <code>selection</code> is provided, consider only the selected <a href="../../../core/types/#ProtoSyn.Atom"><code>Atom</code></a> instances (any given <code>selection</code> will be promoted to be of <a href="../../../core/types/#ProtoSyn.Atom"><code>Atom</code></a> type, see <a href="../../../internals/#ProtoSyn.promote"><code>ProtoSyn.promote</code></a>). In this model, the burial degree <code>Œ©i</code> of each atom is equal to the number (count) of neighbouring <a href="../../../core/types/#ProtoSyn.Atom"><code>Atom</code></a> instances (within the defined <code>rmax</code> cut-off, in Angstrom ‚Ñ´) multiplied by a <code>w1</code> weight, provided by the  <code>identification_curve</code> <code>Function</code>. This <code>Function</code> receives the distance between each pair of neighbouring atoms (as a float), the <code>rmax</code> value and, optionally, a slope control <code>sc</code> value, and return a weight <code>w1</code> (as a float). The <code>identification_curve</code> signature is as follows:</p><pre><code class="nohighlight hljs">identification_curve(distance::T; rmax::T = 9.0, sc::T = 1.0) where {T &lt;: AbstractFloat}</code></pre><p>In order to use pre-defined <code>identification_curve</code> <code>Function</code> instances defined in ProtoSyn, check <a href="#ProtoSyn.Peptides.Calculators.Caterpillar.linear"><code>linear</code></a> and <a href="#ProtoSyn.Peptides.Calculators.Caterpillar.sigmoid"><code>sigmoid</code></a>.</p><p>Note that:     - Shorter <code>rmax</code> value identify buried residues in the local environment (i.e.:     in the scale of the secondary structure, recommended) while a larger <code>rmax</code>     value identifies buried residues in the global scale (i.e.: in comparison with     the whole structure).     - The slope control <code>sc</code> value only has effect in sigmoid     <code>identification_curve</code> <code>Function</code> instances. A smaller value augments the     prevalence of distance information in the <code>w1</code> weight calculation, while a     larger value defines a more strict cut-off (recommended);</p><p>An <a href="../../../core/types/#ProtoSyn.Atom"><code>Atom</code></a> is, therefore, considered buried if the number of neighbors  (multiplied by <code>w1</code>) is over a defined cut-off value <code>Œ©</code>. Buried hydrophobic aminoacids receive an energetic reward, while exposed hydrophobic <a href="../../../core/types/#ProtoSyn.Residue"><code>Residue</code></a> instances receive a penalty (and vice-versa for hydrophylic aminoacids), defined in the provided <code>hydrophobicity_map</code> (hydrophobicity map examples can be found in <code>Peptides.constants.jl</code>) and multiplied by <code>w2</code>, calculated by the <code>hydrophobicity_weight</code> <code>Function</code>. This <code>Function</code> receives the neighbor count <code>Œ©i</code>, the <code>hydrophobicity_map_value</code> and the cut-off value <code>Œ©</code>, returning a <code>w2</code> weight (as a float).  The <code>hydrophobicity_weight</code> signature is as follows:</p><pre><code class="nohighlight hljs">hydrophobicity_weight(‚Ñ¶i::Union{Int, T}; hydrophobicity_map_value::T = 0.0, Œ©::Union{Int, T} = 0.0) where {T &lt;: AbstractFloat}</code></pre><p>In order to use pre-defined <code>hydrophobicity_weight</code> <code>Function</code> instances defined in ProtoSyn, check <a href="../../../internals/#ProtoSyn.Peptides.Calculators.Caterpillar.nc_scalling_exposed_only"><code>nc_scalling_exposed_only</code></a>, <a href="../../../internals/#ProtoSyn.Peptides.Calculators.Caterpillar.nc_non_scalling_exposed_only"><code>nc_non_scalling_exposed_only</code></a>, <a href="../../../internals/#ProtoSyn.Peptides.Calculators.Caterpillar.nc_scalling_all_contributions"><code>nc_scalling_all_contributions</code></a> (recommended) and <a href="../../../internals/#ProtoSyn.Peptides.Calculators.Caterpillar.nc_non_scalling_all_contributions"><code>nc_non_scalling_all_contributions</code></a>.</p><p>The optional <code>A</code> parameter defines the acceleration mode used (SISD<em>0, SIMD</em>1 or CUDA<em>2). If left undefined the default <code>ProtoSyn.acceleration.active</code> mode will be used. This function does not calculate forces (not applicable), and therefore the `update</em>forces` flag serves solely for uniformization with other energy-calculating functions.</p><p><strong>See also</strong></p><p><a href="#ProtoSyn.Peptides.Calculators.Caterpillar.neighbour_vector"><code>neighbour_vector</code></a></p><p><strong>Examples</strong></p><pre><code class="nohighlight hljs">julia&gt; ProtoSyn.Peptides.Calculators.Caterpillar.neighbour_count(pose, false)
(0.0, nothing)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sergio-santos-group/ProtoSyn.jl/blob/b5a50a0f2a0a2e5b8a72028e911f825be1f05a72/src/Peptides/Calculators/Caterpillar/neighbour_count.jl#L1-L68">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ProtoSyn.Peptides.Calculators.Caterpillar.neighbour_vector" href="#ProtoSyn.Peptides.Calculators.Caterpillar.neighbour_vector"><code>ProtoSyn.Peptides.Calculators.Caterpillar.neighbour_vector</code></a> ‚Äî <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">ProtoSyn.Peptides.Calculators.Caterpillar.neighbour_vector([::A], pose::Pose, selection::Opt{AbstractSelection}, [update_forces::Bool = false]; [identification_curve::Function = null_identification_curve], [hydrophobicity_weight::Function = null_hydrophobicity_weight], [rmax::T = 9.0], [sc::T = 1.0], [Œ©::Union{Int, T} = 750.0], [hydrophobicity_map::Dict{String, T} = ProtoSyn.Peptides.doolitle_hydrophobicity]) where {A, T &lt;: AbstractFloat}</code></pre><p>Calculate the given <a href="../../../core/types/#ProtoSyn.Pose"><code>Pose</code></a> <code>pose</code> caterpillar solvation energy using the Neighbour Vector (NV) algorithm (see <a href="https://journals.plos.org/plosone/article?id=10.1371/journal.pone.0020853">this article</a>). If an <code>AbstractSelection</code> <code>selection</code> is provided, consider only the selected <a href="../../../core/types/#ProtoSyn.Atom"><code>Atom</code></a> instances (any given <code>selection</code> will be promoted to be of <a href="../../../core/types/#ProtoSyn.Atom"><code>Atom</code></a> type, see <a href="../../../internals/#ProtoSyn.promote"><code>ProtoSyn.promote</code></a>). In this model, vectors <code>œâi</code> are defined between an <a href="../../../core/types/#ProtoSyn.Atom"><code>Atom</code></a> and all neighbouring <a href="../../../core/types/#ProtoSyn.Atom"><code>Atom</code></a> instances (within the defined <code>rmax</code> cut-off (in Angstrom ‚Ñ´)). Note that only the selected atoms by the <code>selection</code> are considered. A resulting vector <code>Œ©i</code> is calculated by suming all <code>œâi</code> vectors, multiplied by a <code>w1</code> weight, provided by the <code>identification_curve</code> <code>Function</code>. This <code>Function</code> receives the distance between each pair of neighbouring atoms (as a float), the <code>rmax</code> value and, optionally, a slope control <code>sc</code> value, and return a weight <code>w1</code> (as a float). The <code>identification_curve</code> signature is as follows:</p><pre><code class="nohighlight hljs">identification_curve(distance::T; rmax::T = 9.0, sc::T = 1.0) where {T &lt;: AbstractFloat}</code></pre><p>In order to use pre-defined <code>identification_curve</code> <code>Function</code> instances defined in ProtoSyn, check <a href="#ProtoSyn.Peptides.Calculators.Caterpillar.linear"><code>linear</code></a>, <a href="#ProtoSyn.Peptides.Calculators.Caterpillar.sigmoid"><code>sigmoid</code></a> and <a href="#ProtoSyn.Peptides.Calculators.Caterpillar.sigmoid_normalized"><code>sigmoid_normalized</code></a>.</p><p>Note that:</p><ul><li>Shorter <code>rmax</code> value identify buried residues in the local environment (i.e.:</li></ul><p>in the scale of the secondary structure, recommended) while a larger <code>rmax</code>  value identifies buried residues in the global scale (i.e.: in comparison with  the whole structure).</p><ul><li>The slope control <code>sc</code> value only has effect in sigmoid</li></ul><p><code>identification_curve</code> <code>Function</code> instances. A smaller value augments the  prevalence of distance information in the <code>w1</code> weight calculation, while a  larger value defines a more strict cut-off (recommended);</p><p>An <a href="../../../core/types/#ProtoSyn.Atom"><code>Atom</code></a> is, therefore, considered buried if the magnitude of the resulting vector from the sum of the <code>œâi</code> (multiplied by <code>w1</code>) is within a defined cut-off value <code>Œ©</code>. Buried hydrophobic aminoacids receive an energetic reward, while exposed hydrophobic <a href="../../../core/types/#ProtoSyn.Residue"><code>Residue</code></a> instances receive a penalty (and vice-versa for hydrophylic aminoacids), defined in the provided <code>hydrophobicity_map</code> (hydrophobicity map examples can be found in <code>Peptides.constants.jl</code>) and multiplied by <code>w2</code>, calculated by the <code>hydrophobicity_weight</code> <code>Function</code>. This <code>Function</code> receives the vector magnitude <code>Œ©i</code>, the <code>hydrophobicity_map_value</code> and the cut-off value <code>Œ©</code>, returning a <code>w2</code> (as a float).  The <code>hydrophobicity_weight</code> signature is as follows:</p><pre><code class="nohighlight hljs">hydrophobicity_weight(‚Ñ¶i::Union{Int, T}; hydrophobicity_map_value::T = 0.0, Œ©::Union{Int, T} = 0.0) where {T &lt;: AbstractFloat}</code></pre><p>In order to use pre-defined <code>hydrophobicity_weight</code> <code>Function</code> instances defined in ProtoSyn, check <a href="../../../internals/#ProtoSyn.Peptides.Calculators.Caterpillar.nv_scalling_exposed_only"><code>nv_scalling_exposed_only</code></a>, <a href="../../../internals/#ProtoSyn.Peptides.Calculators.Caterpillar.nv_non_scalling_exposed_only"><code>nv_non_scalling_exposed_only</code></a>, <a href="../../../internals/#ProtoSyn.Peptides.Calculators.Caterpillar.nv_scalling_all_contributions"><code>nv_scalling_all_contributions</code></a> (recommended) and <a href="../../../internals/#ProtoSyn.Peptides.Calculators.Caterpillar.nv_non_scalling_all_contributions"><code>nv_non_scalling_all_contributions</code></a>.</p><p>The optional <code>A</code> parameter defines the acceleration mode used (SISD<em>0, SIMD</em>1 or CUDA<em>2). If left undefined the default <code>ProtoSyn.acceleration.active</code> mode will be used. This function does not calculate forces (not applicable), and therefore the `update</em>forces` flag serves solely for uniformization with other energy-calculating functions.</p><p><strong>See also</strong></p><p><a href="#ProtoSyn.Peptides.Calculators.Caterpillar.neighbour_count"><code>neighbour_count</code></a></p><p><strong>Examples</strong></p><pre><code class="nohighlight hljs">julia&gt; ProtoSyn.Peptides.Calculators.Caterpillar.neighbour_vector(pose, false)
(0.0, nothing)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sergio-santos-group/ProtoSyn.jl/blob/b5a50a0f2a0a2e5b8a72028e911f825be1f05a72/src/Peptides/Calculators/Caterpillar/neighbour_vector.jl#L1-L71">source</a></section></article><p><img src="../../../../assets/ProtoSyn-nc-nv.png" alt="ProtoSyn Neighbour Count Neighbour Vector"/></p><p><strong>Figure 1 |</strong> Visualization of <a href="#ProtoSyn.Peptides.Calculators.Caterpillar.neighbour_count"><code>neighbour_count</code></a> and <a href="#ProtoSyn.Peptides.Calculators.Caterpillar.neighbour_vector"><code>neighbour_vector</code></a> algorithms for burial degree calculation. <strong>A - Neighbour count -</strong> Since only the number of selected atoms within the <code>rmax</code> cutoff is accounted for, both depicted conformations are measured as having the same burial degree, even though atom B is more exposed to the system&#39;s solvent. <strong>B - Neighbour vector -</strong> Using the neighbour vector algorithm, the resulting vector from summing all individual vectors from the selected atom towards all neighbouring selected atoms (within <code>rmax</code>) provides a more clear distinction between exposed or non-exposed <a href="../../../core/types/#ProtoSyn.Atom"><code>Atom</code></a> instances: resulting vectors with higher magnitude are linearly and positively correlated with atoms with more exposed surfaces. Note that, on average, the NV algorithm was measured to be 4-5x slower than NC.</p><h3 id=".2-Identification-curve"><a class="docs-heading-anchor" href="#.2-Identification-curve">1.2 Identification curve</a><a id=".2-Identification-curve-1"></a><a class="docs-heading-anchor-permalink" href="#.2-Identification-curve" title="Permalink"></a></h3><p>The available identification curves are <code>linear</code>, <code>sigmoid</code> and <code>normalized sigmoid</code> (in NV algorithms only). Note that the definition of the identification curve controls the amount of distance information considered for the calculation of the burial degree: linear identification curves incorporate more distance information than sigmoid identification curves (normalized sigmoid, in NV algorithms, use the least distance information, similar to NC algorithms).</p><article class="docstring"><header><a class="docstring-binding" id="ProtoSyn.Peptides.Calculators.Caterpillar.linear" href="#ProtoSyn.Peptides.Calculators.Caterpillar.linear"><code>ProtoSyn.Peptides.Calculators.Caterpillar.linear</code></a> ‚Äî <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">linear(distance::T; rmax::T = 9.0, sc::T = 1.0) where {T &lt;: AbstractFloat}</code></pre><p>Returns the linear identification curve weight <code>w1</code> (max at <code>distance</code> 0.0, linearly decreasing until <code>rmax</code>). Note that slope control <code>sc</code> has no effect.</p><p><strong>See also</strong></p><p><a href="#ProtoSyn.Peptides.Calculators.Caterpillar.sigmoid"><code>sigmoid</code></a> <a href="#ProtoSyn.Peptides.Calculators.Caterpillar.sigmoid_normalized"><code>sigmoid_normalized</code></a></p><p><strong>Examples</strong></p><pre><code class="nohighlight hljs">julia&gt; ProtoSyn.Peptides.Calculators.Caterpillar.linear(10.0, rmax = 20.0)
0.5</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sergio-santos-group/ProtoSyn.jl/blob/b5a50a0f2a0a2e5b8a72028e911f825be1f05a72/src/Peptides/Calculators/Caterpillar/identification_curve.jl#L1-L15">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ProtoSyn.Peptides.Calculators.Caterpillar.sigmoid" href="#ProtoSyn.Peptides.Calculators.Caterpillar.sigmoid"><code>ProtoSyn.Peptides.Calculators.Caterpillar.sigmoid</code></a> ‚Äî <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">sigmoid(distance::T; rmax::T = 9.0, sc::T = 1.0) where {T &lt;: AbstractFloat}</code></pre><p>Returns the sigmoid identification curve weight <code>w1</code> (max at <code>distance</code> 0.0, min at distance <code>rmax</code>). The slope control <code>sc</code> defines how sharp the sigmoid curve is.</p><p><strong>See also</strong></p><p><a href="#ProtoSyn.Peptides.Calculators.Caterpillar.linear"><code>linear</code></a> <a href="#ProtoSyn.Peptides.Calculators.Caterpillar.sigmoid_normalized"><code>sigmoid_normalized</code></a></p><p><strong>Examples</strong></p><pre><code class="nohighlight hljs">julia&gt; ProtoSyn.Peptides.Calculators.Caterpillar.sigmoid(10.0, rmax = 20.0)
0.9999546021312976</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sergio-santos-group/ProtoSyn.jl/blob/b5a50a0f2a0a2e5b8a72028e911f825be1f05a72/src/Peptides/Calculators/Caterpillar/identification_curve.jl#L21-L36">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ProtoSyn.Peptides.Calculators.Caterpillar.sigmoid_normalized" href="#ProtoSyn.Peptides.Calculators.Caterpillar.sigmoid_normalized"><code>ProtoSyn.Peptides.Calculators.Caterpillar.sigmoid_normalized</code></a> ‚Äî <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">sigmoid_normalized(distance::T; rmax::T = 9.0, sc::T = 1.0) where {T &lt;: AbstractFloat}</code></pre><p>Returns the sigmoid identification curve weight <code>w1</code> (max at <code>distance</code> 0.0, min at distance <code>rmax</code>), normalized by the given distance (should only be  applied in Neighbor Vector (NV) algorithms). The slope control <code>sc</code> defines how sharp the sigmoid curve is.</p><p><strong>See also</strong></p><p><a href="#ProtoSyn.Peptides.Calculators.Caterpillar.linear"><code>linear</code></a> <a href="#ProtoSyn.Peptides.Calculators.Caterpillar.sigmoid"><code>sigmoid</code></a></p><p><strong>Examples</strong></p><pre><code class="nohighlight hljs">julia&gt; ProtoSyn.Peptides.Calculators.Caterpillar.sigmoid_normalized(10.0, rmax = 20.0)
0.09999546021312976</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sergio-santos-group/ProtoSyn.jl/blob/b5a50a0f2a0a2e5b8a72028e911f825be1f05a72/src/Peptides/Calculators/Caterpillar/identification_curve.jl#L42-L58">source</a></section></article><h3 id=".3-Selection-atom"><a class="docs-heading-anchor" href="#.3-Selection-atom">1.3 Selection atom</a><a id=".3-Selection-atom-1"></a><a class="docs-heading-anchor-permalink" href="#.3-Selection-atom" title="Permalink"></a></h3><p>This can be any selection that yields an atom. However, in most cases applied to proteins, either the CŒ± or CŒ≤ atoms should be chosen.</p><h3 id=".4-rmax-cutoff"><a class="docs-heading-anchor" href="#.4-rmax-cutoff">1.4 <code>rmax</code> cutoff</a><a id=".4-rmax-cutoff-1"></a><a class="docs-heading-anchor-permalink" href="#.4-rmax-cutoff" title="Permalink"></a></h3><p>This can be any float number, however, the range between 9.0‚Ñ´ and 50.0‚Ñ´ was identified as yielding the best results. Note that short <code>rmax</code> values cause a much more localized identification of burial degrees (i.e.: in comparison with the rest of the local secondary structure) while larger <code>rmax</code> values identify a more global level of burial (i.e.: in comparison with all aminoacids in the structure).</p><h3 id=".5-Slope-control-(sc)"><a class="docs-heading-anchor" href="#.5-Slope-control-(sc)">1.5 Slope control (<code>sc</code>)</a><a id=".5-Slope-control-(sc)-1"></a><a class="docs-heading-anchor-permalink" href="#.5-Slope-control-(sc)" title="Permalink"></a></h3><p>This value controls the slope degree in sigmoid identification curves (only). Lower values yield less pronounced slopes (therefore taking more distance information into consideration) while higher sc values define more strict cut off lines.</p><h2 id=".-Hydrophobicity-weight-calculation"><a class="docs-heading-anchor" href="#.-Hydrophobicity-weight-calculation">2. Hydrophobicity weight calculation</a><a id=".-Hydrophobicity-weight-calculation-1"></a><a class="docs-heading-anchor-permalink" href="#.-Hydrophobicity-weight-calculation" title="Permalink"></a></h2><p>The final Caterpilar&#39;s solvation energy multiplies the calculated burial degree by an hydrophobicity weight: hydrophobic <a href="../../../core/types/#ProtoSyn.Residue"><code>Residue</code></a> instances receive a penalty when exposed and vice-versa. The buried/unburied distinction is defined by the user using the <code>Œ©</code> field: buried degress bellow <code>Œ©</code> are considered buried. The difference between burial degree and <code>Œ©</code> is then multiplied by the hydrophobicity index. By default, ProtoSyn employs the <a href="https://resources.qiagenbioinformatics.com/manuals/clcgenomicsworkbench/650/Hydrophobicity_scales.html">Doolittle Hydrophobicity Index</a>, when working with proteins and peptides.</p><article class="docstring"><header><a class="docstring-binding" id="ProtoSyn.Peptides.Calculators.Caterpillar.get_default_caterpillar_solvation_energy" href="#ProtoSyn.Peptides.Calculators.Caterpillar.get_default_caterpillar_solvation_energy"><code>ProtoSyn.Peptides.Calculators.Caterpillar.get_default_caterpillar_solvation_energy</code></a> ‚Äî <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">get_default_caterpillar_solvation_energy(;[Œ±::T = 1.0]) where {T &lt;: AbstractFloat}</code></pre><p>Return the default Caterpillar solvation energy energy <a href="../../../core/calculators/calculators-section/#ProtoSyn.Calculators.EnergyFunctionComponent"><code>EnergyFunctionComponent</code></a>. <code>Œ±</code> sets the component weight (on an <a href="../../../core/calculators/calculators-section/#ProtoSyn.Calculators.EnergyFunction"><code>EnergyFunction</code></a> instance, <code>1.0</code> by default). This function employs <a href="#ProtoSyn.Peptides.Calculators.Caterpillar.neighbour_vector"><code>neighbour_vector</code></a> as the <code>:calc</code> function.</p><p><strong>Settings</strong></p><ul><li><code>hydrophobicity_weight::Function</code> - Returns the hydrophobicity weight of a given burial degree based on a hydrophobicity map value and default buried state;</li><li><code>identification_curve::Function</code> - Returns the burial degree weight given an inter-atomic distance, rmax and slope control value;</li><li><code>Œ©::Union{Int, T}</code> - The default buried state (the average, buried degrees above this value are considered buried);</li><li><code>sc::T = 1.0</code> - Slope control, used in sigmoid identification curves to control how sharp to consider an interaction as buried or not.</li><li><code>hydrophobicity_map::Dict{String, T}</code> - A 1-on-1 map between <a href="../../../core/types/#ProtoSyn.Residue"><code>Residue</code></a> types and hydrophobicity indexes;</li><li><code>rmax::T</code> - The cutoff value to consider some inter-atomic interaction as buriable; </li></ul><p><strong>Examples</strong></p><pre><code class="language-julia-repl hljs">julia&gt; ProtoSyn.Peptides.Calculators.Caterpillar.get_default_caterpillar_solvation_energy()
üûß  Energy Function Component:
+---------------------------------------------------+
| Name           | Caterpillar_Solv                 |
| Alpha (Œ±)      | 1.0                              |
| Update forces  | false                            |
| Calculator     | neighbour_vector                 |
+---------------------------------------------------+
 |    +----------------------------------------------------------------------------------+
 ‚îú‚îÄ‚îÄ  ‚óè Settings                      | Value                                            |
 |    +----------------------------------------------------------------------------------+
 |    | hydrophobicity_weight         | nv_scalling_all_contributions                    |
 |    | identification_curve          | sigmoid                                          |
 |    | Œ©                             | 24.0                                             |
 |    | sc                            | 1.0                                              |
 |    | hydrophobicity_map            | Dict{String, Float64}(21 components)             |
 |    | rmax                          | 9.0                                              |
 |    +----------------------------------------------------------------------------------+
 |    
 ‚îî‚îÄ‚îÄ  ‚óè  Selection:
      ‚îî‚îÄ‚îÄ BinarySelection ‚ùØ  | &quot;or&quot; (Atom)
           ‚îú‚îÄ‚îÄ FieldSelection ‚Ä∫ Atom.name = CB
           ‚îî‚îÄ‚îÄ BinarySelection ‚ùØ  &amp; &quot;and&quot; (Atom)
                ‚îú‚îÄ‚îÄ FieldSelection ‚Ä∫ Atom.name = HA2
                ‚îî‚îÄ‚îÄ FieldSelection ‚Ä∫ Residue.name = GLY</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sergio-santos-group/ProtoSyn.jl/blob/b5a50a0f2a0a2e5b8a72028e911f825be1f05a72/src/Peptides/Calculators/Caterpillar/Caterpillar.jl#L21-L66">source</a></section></article><p><img src="../../../../assets/ProtoSyn-caterpillar-solvation.png" alt="ProtoSyn Caterpillar Solvation"/></p><p><strong>Figure 1 |</strong> A diagram representation of the <a href="#Caterpillar-Solvation">Caterpillar Solvation</a> <a href="../../../core/calculators/calculators-section/#ProtoSyn.Calculators.EnergyFunctionComponent"><code>EnergyFunctionComponent</code></a>. The energy penalty is proportional to the hydrophobicity value (in the hydrophobicity map) multiplied by the excess number of CŒ± contacts (above ‚Ñ¶).</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../ss-propensity/">¬´ Secondary structure propensity</a><a class="docs-footer-nextpage" href="../seqdes/">SeqDes model ¬ª</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.19 on <span class="colophon-date" title="Monday 4 July 2022 16:15">Monday 4 July 2022</span>. Using Julia version 1.7.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
