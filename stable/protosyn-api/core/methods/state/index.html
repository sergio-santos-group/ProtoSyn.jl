<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>State · ProtoSyn.jl</title><script data-outdated-warner src="../../../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.039/juliamono-regular.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../../assets/documenter.js"></script><script src="../../../../siteinfo.js"></script><script src="../../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../../assets/themeswap.js"></script><link href="../../../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../../../"><img src="../../../../assets/logo.png" alt="ProtoSyn.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../../../">ProtoSyn.jl</a></span></div><form class="docs-search" action="../../../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../../../">Home</a></li><li><span class="tocitem">Getting Started</span><ul><li><a class="tocitem" href="../../../../getting-started/installation/">Installation</a></li><li><a class="tocitem" href="../../../../getting-started/first-steps/">First steps</a></li><li><a class="tocitem" href="../../../../getting-started/examples/">Examples</a></li></ul></li><li><span class="tocitem">ProtoSyn API</span><ul><li><input class="collapse-toggle" id="menuitem-3-1" type="checkbox" checked/><label class="tocitem" for="menuitem-3-1"><span class="docs-label">Core</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../types/">Types</a></li><li><input class="collapse-toggle" id="menuitem-3-1-2" type="checkbox" checked/><label class="tocitem" for="menuitem-3-1-2"><span class="docs-label">Methods</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../graph/">Graph</a></li><li class="is-active"><a class="tocitem" href>State</a><ul class="internal"><li><a class="tocitem" href="#Cartesian-and-internal-coordinates-conversion"><span>Cartesian and internal coordinates conversion</span></a></li><li><a class="tocitem" href="#Dihedral-rotations"><span>Dihedral rotations</span></a></li><li><a class="tocitem" href="#Measuring-distances,-angles-and-dihedrals"><span>Measuring distances, angles and dihedrals</span></a></li><li><a class="tocitem" href="#core-state-methods-indexation"><span>Indexation</span></a></li></ul></li><li><a class="tocitem" href="../pose/">Pose</a></li><li><a class="tocitem" href="../io/">Input and Output (IO)</a></li><li><a class="tocitem" href="../aux/">Auxiliary methods</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-1-3" type="checkbox"/><label class="tocitem" for="menuitem-3-1-3"><span class="docs-label">Calculators</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../calculators/calculators-section/">Calculators Section</a></li><li><a class="tocitem" href="../../calculators/torchani/">TorchANI</a></li><li><a class="tocitem" href="../../calculators/bond-distance-restraint/">Bond distance Restraint</a></li><li><a class="tocitem" href="../../calculators/potential-restraints/">Potential Restraints</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-1-4" type="checkbox"/><label class="tocitem" for="menuitem-3-1-4"><span class="docs-label">Mutators</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../mutators/mutators-section/">Mutators Section</a></li><li><a class="tocitem" href="../../mutators/mutators-dihedral/">Dihedral Mutator</a></li><li><a class="tocitem" href="../../mutators/mutators-crankshaft/">Crankshaft Mutator</a></li><li><a class="tocitem" href="../../mutators/mutators-rigid-body/">Rigid Body Mutators</a></li><li><a class="tocitem" href="../../mutators/mutators-compound/">Compound Mutators</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-1-5" type="checkbox"/><label class="tocitem" for="menuitem-3-1-5"><span class="docs-label">Drivers</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../drivers/drivers-section/">Drivers Section</a></li><li><a class="tocitem" href="../../drivers/drivers-monte-carlo/">Monte Carlo</a></li><li><a class="tocitem" href="../../drivers/drivers-steepest-descent/">Steepest Descent</a></li><li><a class="tocitem" href="../../drivers/drivers-ils/">ILS</a></li><li><a class="tocitem" href="../../drivers/drivers-compound/">Compound Driver</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-1-6" type="checkbox"/><label class="tocitem" for="menuitem-3-1-6"><span class="docs-label">Submodules</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../submodules/selections/">Selections</a></li><li><a class="tocitem" href="../../submodules/builder/">Builder</a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-2" type="checkbox"/><label class="tocitem" for="menuitem-3-2"><span class="docs-label">Peptides</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../peptides/introduction/">Introduction</a></li><li><a class="tocitem" href="../../../peptides/types/">Types</a></li><li><input class="collapse-toggle" id="menuitem-3-2-3" type="checkbox"/><label class="tocitem" for="menuitem-3-2-3"><span class="docs-label">Methods</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../peptides/methods/io/">Input and Output (IO)</a></li><li><a class="tocitem" href="../../../peptides/methods/graph/">Graph</a></li><li><a class="tocitem" href="../../../peptides/methods/state/">State</a></li><li><a class="tocitem" href="../../../peptides/methods/pose/">Pose</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-2-4" type="checkbox"/><label class="tocitem" for="menuitem-3-2-4"><span class="docs-label">Calculators</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../peptides/calculators/sidechain-clash-restraint/">Sidechain Clash Restraint</a></li><li><a class="tocitem" href="../../../peptides/calculators/contact-restraint/">Contact Restraint</a></li><li><a class="tocitem" href="../../../peptides/calculators/ca-ca-clash-restraint/">Cα-Cα Clash Restraint</a></li><li><a class="tocitem" href="../../../peptides/calculators/caterpillar-solvation/">Caterpillar Solvation</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-2-5" type="checkbox"/><label class="tocitem" for="menuitem-3-2-5"><span class="docs-label">Mutators</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../peptides/mutators/rotamer/">Rotamer Mutator</a></li><li><a class="tocitem" href="../../../peptides/mutators/design/">Design Mutator</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-2-6" type="checkbox"/><label class="tocitem" for="menuitem-3-2-6"><span class="docs-label">Drivers</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../peptides/drivers/rotamer-blitz-driver/">Rotamer Blitz</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-2-7" type="checkbox"/><label class="tocitem" for="menuitem-3-2-7"><span class="docs-label">Submodules</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../peptides/submodules/selections/">Selections</a></li><li><a class="tocitem" href="../../../peptides/submodules/builder/">Builder</a></li><li><a class="tocitem" href="../../../peptides/submodules/rotamers/">Rotamers</a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-3" type="checkbox"/><label class="tocitem" for="menuitem-3-3"><span class="docs-label">Materials</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../materials/introduction/">Introduction</a></li><li><input class="collapse-toggle" id="menuitem-3-3-2" type="checkbox"/><label class="tocitem" for="menuitem-3-3-2"><span class="docs-label">Methods</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../materials/methods/lattices/">Lattices</a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-4" type="checkbox"/><label class="tocitem" for="menuitem-3-4"><span class="docs-label">Sugars</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../sugars/introduction/">Introduction</a></li><li><input class="collapse-toggle" id="menuitem-3-4-2" type="checkbox"/><label class="tocitem" for="menuitem-3-4-2"><span class="docs-label">Submodules</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../sugars/submodules/builder/">Builder</a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-5" type="checkbox"/><label class="tocitem" for="menuitem-3-5"><span class="docs-label">Common</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../common/introduction/">Introduction</a></li></ul></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">ProtoSyn API</a></li><li><a class="is-disabled">Core</a></li><li><a class="is-disabled">Methods</a></li><li class="is-active"><a href>State</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>State</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/sergio-santos-group/ProtoSyn.jl/blob/master/docs/src/protosyn-api/core/methods/state.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="core-state-methods"><a class="docs-heading-anchor" href="#core-state-methods">State</a><a id="core-state-methods-1"></a><a class="docs-heading-anchor-permalink" href="#core-state-methods" title="Permalink"></a></h1><p>This section lists functions that work on the system <a href="../../types/#state-types">State</a>. These methods are subdivided by topics, for organization purposes:</p><ul><li><a href="#Cartesian-and-internal-coordinates-conversion">Cartesian and internal coordinates conversion</a></li><li><a href="#Dihedral-rotations">Dihedral rotations</a></li><li><a href="#Measuring-distances,-angles-and-dihedrals">Measuring distances, angles and dihedrals</a></li><li><a href="#core-state-methods-indexation">Indexation</a></li></ul><h2 id="Cartesian-and-internal-coordinates-conversion"><a class="docs-heading-anchor" href="#Cartesian-and-internal-coordinates-conversion">Cartesian and internal coordinates conversion</a><a id="Cartesian-and-internal-coordinates-conversion-1"></a><a class="docs-heading-anchor-permalink" href="#Cartesian-and-internal-coordinates-conversion" title="Permalink"></a></h2><p>The following functions deal with the conversion from internal to cartesian coordinates and vice-versa.</p><div class="admonition is-category-ukw"><header class="admonition-header">Note:</header><div class="admonition-body"><p>Internal to cartesian conversion functions (and vice-versa) only apply to <a href="../../types/#ProtoSyn.AtomState"><code>AtomState</code></a> instances that have been modified (and therefore have the <code>:changed</code> field set to <code>true</code>). In the case of internal to cartesian coordinates conversion, updating any <a href="../../types/#ProtoSyn.AtomState"><code>AtomState</code></a> automatically forces downstream <a href="../../types/#ProtoSyn.AtomState"><code>AtomState</code></a> instances to be changed, and therefore updated. Note that the <code>:changed</code> flag is automatically set to <code>true</code> when modifying any <a href="../../types/#ProtoSyn.AtomState"><code>AtomState</code></a> field (including when changing the paired <code>state.x</code> <a href="../../types/#ProtoSyn.StateMatrix"><code>StateMatrix</code></a>), but the container <code>state.i2c</code> flag is not altered until explicitly request by <a href="#ProtoSyn.request_i2c!"><code>request_i2c!</code></a> or <a href="#ProtoSyn.request_c2i!"><code>request_c2i!</code></a> methods.</p></div></div><article class="docstring"><header><a class="docstring-binding" id="ProtoSyn.request_c2i!" href="#ProtoSyn.request_c2i!"><code>ProtoSyn.request_c2i!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">request_c2i!(state::State; [all::Bool = false])</code></pre><p>Sets <code>state.c2i</code> to <code>true</code>. If <code>all</code> is set to <code>true</code> (<code>false</code>, by default), update all <a href="../../types/#ProtoSyn.AtomState"><code>AtomState</code></a> instances in the given <a href="../../types/#state-types">State</a> <code>state</code> to have <code>:changed</code> field set to <code>true</code>. Return the altered <a href="../../types/#state-types">State</a> <code>state</code>.</p><p><strong>See also</strong></p><p><a href="#ProtoSyn.request_i2c!"><code>request_i2c!</code></a> <a href="#ProtoSyn.c2i!"><code>c2i!</code></a></p><p><strong>Examples</strong></p><pre><code class="language-julia-repl">julia&gt; ProtoSyn.request_c2i!(pose.state)
State{Float64}:
 Size: 343
 i2c: false | c2i: true
 Energy: Dict(:Total =&gt; Inf)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sergio-santos-group/ProtoSyn.jl/blob/3a5f148f31782f4c86c163bc48e475ec9945b7ba/src/Core/Methods/state.jl#L5-L23">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ProtoSyn.request_i2c!" href="#ProtoSyn.request_i2c!"><code>ProtoSyn.request_i2c!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">request_i2c!(state::State; [all::Bool = false])</code></pre><p>Sets <code>state.i2c</code> to <code>true</code>. If <code>all</code> is set to <code>true</code> (<code>false</code>, by default), update the first <a href="../../types/#ProtoSyn.AtomState"><code>AtomState</code></a> instance in the given <a href="../../types/#state-types">State</a> <code>state</code> (in the Root) to have <code>:changed</code> field set to <code>true</code>. Return the altered <a href="../../types/#state-types">State</a> <code>state</code>.</p><p><strong>See also</strong></p><p><a href="#ProtoSyn.request_c2i!"><code>request_c2i!</code></a> <a href="#ProtoSyn.i2c!"><code>i2c!</code></a></p><p><strong>Examples</strong></p><pre><code class="language-julia-repl">julia&gt; ProtoSyn.request_i2c!(pose.state)
State{Float64}:
 Size: 343
 i2c: true | c2i: false
 Energy: Dict(:Total =&gt; Inf)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sergio-santos-group/ProtoSyn.jl/blob/3a5f148f31782f4c86c163bc48e475ec9945b7ba/src/Core/Methods/state.jl#L36-L55">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ProtoSyn.c2i!" href="#ProtoSyn.c2i!"><code>ProtoSyn.c2i!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">c2i!(state::State{T}, top::Topology)</code></pre><p>Update the internal coordinates to match the measured cartesian coordinates, in the given <a href="../../types/#ProtoSyn.State"><code>State</code></a> <code>state</code>. Note that only the <a href="../../types/#ProtoSyn.AtomState"><code>AtomState</code></a> instances with <code>:changed</code> field set to <code>true</code> will be updated, and the flag is therefore changed to <code>false</code>. Return the altered <a href="../../types/#ProtoSyn.State"><code>State</code></a> <code>state</code> instance. If <code>state.c2i</code> is not set to <code>true</code>, return the original <a href="../../types/#ProtoSyn.State"><code>State</code></a> <code>state</code> instance, without changes.</p><p><strong>See also</strong></p><p><a href="#ProtoSyn.i2c!"><code>i2c!</code></a> <a href="#ProtoSyn.request_c2i!"><code>request_c2i!</code></a></p><p><strong>Examples</strong></p><pre><code class="language-julia-repl">julia&gt; ProtoSyn.c2i!(pose.state, pose.graph)
State{Float64}:
 Size: 343
 i2c: false | c2i: false
 Energy: Dict(:Total =&gt; Inf)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sergio-santos-group/ProtoSyn.jl/blob/3a5f148f31782f4c86c163bc48e475ec9945b7ba/src/Core/Methods/state.jl#L116-L137">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ProtoSyn.i2c!" href="#ProtoSyn.i2c!"><code>ProtoSyn.i2c!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">i2c!(state::State{T}, top::Topology)</code></pre><p>Update the cartesian coordinates to match the measured internal coordinates, in the given <a href="../../types/#ProtoSyn.State"><code>State</code></a> <code>state</code>. Note that only the <a href="../../types/#ProtoSyn.AtomState"><code>AtomState</code></a> instances with <code>:changed</code> field set to <code>true</code> will be updated, and the flag is therefore changed to <code>false</code>. Return the altered <a href="../../types/#ProtoSyn.State"><code>State</code></a> <code>state</code> instance. If <code>state.c2i</code> is not set to <code>true</code>, return the original <a href="../../types/#ProtoSyn.State"><code>State</code></a> <code>state</code> instance, without changes.</p><div class="admonition is-category-ukw"><header class="admonition-header">Note:</header><div class="admonition-body"><p>Any <a href="../../types/#ProtoSyn.AtomState"><code>AtomState</code></a> that requires an update (has <code>:changed</code> flag set to <code>true</code>) will cause all downstream residues to be updated as well (in the same <a href="../../types/#state-types">Graph</a>).</p></div></div><p><strong>See also</strong></p><p><a href="#ProtoSyn.c2i!"><code>c2i!</code></a> <a href="#ProtoSyn.request_i2c!"><code>request_i2c!</code></a></p><p><strong>Examples</strong></p><pre><code class="language-julia-repl">julia&gt; ProtoSyn.i2c!(pose.state, pose.graph)
State{Float64}:
 Size: 343
 i2c: false | c2i: false
 Energy: Dict(:Total =&gt; Inf)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sergio-santos-group/ProtoSyn.jl/blob/3a5f148f31782f4c86c163bc48e475ec9945b7ba/src/Core/Methods/state.jl#L168-L194">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ProtoSyn.sync!" href="#ProtoSyn.sync!"><code>ProtoSyn.sync!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">sync!(state::State, topology::Topology)</code></pre><p>Check whether the given <a href="../../types/#ProtoSyn.State"><code>State</code></a> <code>state</code> instance has either <code>i2c</code> or <code>c2i</code> flag set to <code>true</code> and if so update the cartesian/internal coordinates accordingly. Return the altered <a href="../../types/#ProtoSyn.State"><code>State</code></a> instance. </p><pre><code class="nohighlight">sync!(pose::Pose)</code></pre><p>Check whether the given <a href="../../types/#Pose">Pose</a> instance has either <code>i2c</code> or <code>c2i</code> flag set to <code>true</code> in its <code>pose.state</code> field and if so update the cartesian/internal coordinates accordingly. Return the altered <a href="../../types/#Pose">Pose</a> instance. </p><div class="admonition is-category-ukw"><header class="admonition-header">Note:</header><div class="admonition-body"><p>Requesting both <code>i2c</code> and <code>c2i</code> conversions simultaneously is not possible and will result in an error. Consider calling <a href="#ProtoSyn.i2c!"><code>i2c!</code></a> or <a href="#ProtoSyn.c2i!"><code>c2i!</code></a> to choose one of the coordinate systems to be synched. </p></div></div><p><strong>See also</strong></p><p><a href="#ProtoSyn.i2c!"><code>i2c!</code></a> <a href="#ProtoSyn.c2i!"><code>c2i!</code></a></p><p><strong>Examples</strong></p><pre><code class="language-julia-repl">julia&gt; sync!(pose.state, pose.graph)
State{Float64}:
 Size: 343
 i2c: false | c2i: false
 Energy: Dict(:Total =&gt; Inf)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sergio-santos-group/ProtoSyn.jl/blob/3a5f148f31782f4c86c163bc48e475ec9945b7ba/src/Core/Methods/state.jl#L65-L94">source</a></section></article><p><img src="../../../../assets/ProtoSyn-c&amp;i.png" alt="ProtoSyn c&amp;i"/></p><p><strong>Figure 1 |</strong> A diagram depicting the differences between the cartesian and internal coordinate systems. In the case of cartesian coordinates, each <a href="../../types/#ProtoSyn.AtomState"><code>AtomState</code></a> position is described by 3 numbers, the <code>X</code>, <code>Y</code> and <code>Z</code> coordinates. A <a href="../../types/#ProtoSyn.StateMatrix"><code>StateMatrix</code></a> compiles all cartesian coordinates and is useful when applying certain types of conformation changes. Employing the <a href="#ProtoSyn.c2i!"><code>c2i!</code></a> function allows for the synchronization of cartesian coordinates to internal coordinates. In this coordinate system, the position of each atom is still described by 3 numbers, but these are now the distance (<code>b</code>), angle (<code>θ</code>) and dihedral angle (<code>ϕ</code>) values <em>relative</em> to the parent/grand-parents. As an example, the position of the highlighted atom 12 is described by the distance to atom 11, the angle between atoms 9, 11 and itself, and finally by the dihedral angle of the atoms 8, 9, 11 and itself. Since a set of <a href="../graph/#ProtoSyn.ascendents"><code>ascendents</code></a> is necessary to establish the position of an <a href="../../types/#ProtoSyn.AtomState"><code>AtomState</code></a>, a set of 3 pseudoatoms (know as <strong>root</strong>) is necessary at the beggining of a <a href="../../types/#ProtoSyn.Topology"><code>Topology</code></a>. Using this type of coordinates, it becomes extremly simple and efficient to perform large scale rotations of dihedral angles, since all positions are calculated based on the <em>relative</em> position to the <a href="../graph/#ProtoSyn.ascendents"><code>ascendents</code></a>. Employing the <a href="#ProtoSyn.i2c!"><code>i2c!</code></a> function allows for the synchronization from internal coordinates to cartesian coordinates.</p><h2 id="Dihedral-rotations"><a class="docs-heading-anchor" href="#Dihedral-rotations">Dihedral rotations</a><a id="Dihedral-rotations-1"></a><a class="docs-heading-anchor-permalink" href="#Dihedral-rotations" title="Permalink"></a></h2><p>The next functions deal with setting and rotating dihedral angles.</p><article class="docstring"><header><a class="docstring-binding" id="ProtoSyn.getdihedral" href="#ProtoSyn.getdihedral"><code>ProtoSyn.getdihedral</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">getdihedral(state::State, atom::Atom)</code></pre><p>Get the current dihedral value for <a href="../../types/#ProtoSyn.Atom"><code>Atom</code></a> <code>atom</code> of <a href="../../types/#ProtoSyn.State"><code>State</code></a> <code>state</code> (in radians, based on the internal coordinates). This value is the sum of the intrisic dihedral angle <code>ϕ</code> and the second ascendent <code>Δϕ</code>.</p><p><strong>See also</strong></p><p><a href="../graph/#ProtoSyn.ascendents"><code>ascendents</code></a> <a href="#ProtoSyn.setdihedral!"><code>setdihedral!</code></a> <a href="#ProtoSyn.dihedral"><code>dihedral</code></a></p><p><strong>Examples</strong></p><pre><code class="language-julia-repl">julia&gt; getdihedral(pose.state, pose.graph[1][2][&quot;N&quot;])
3.141592653589793</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sergio-santos-group/ProtoSyn.jl/blob/3a5f148f31782f4c86c163bc48e475ec9945b7ba/src/Core/Methods/state.jl#L335-L350">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ProtoSyn.setdihedral!" href="#ProtoSyn.setdihedral!"><code>ProtoSyn.setdihedral!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">setdihedral!(state::State, atom::Atom, value::T) where {T &lt;: AbstractFloat}</code></pre><p>Set the dihedral in <a href="../../types/#ProtoSyn.Atom"><code>Atom</code></a> <code>atom</code> of <a href="../../types/#ProtoSyn.State"><code>State</code></a> <code>state</code> to be exactly <code>value</code> (in radians). Automatically requests internal to cartesian coordinate conversion (by setting <code>state.i2c</code> as <code>true</code>). Return the altered <a href="../../types/#ProtoSyn.State"><code>State</code></a> <code>state</code>.</p><p><strong>See also</strong></p><p><a href="../graph/#ProtoSyn.ascendents"><code>ascendents</code></a> <a href="#ProtoSyn.request_i2c!"><code>request_i2c!</code></a> <a href="#ProtoSyn.getdihedral"><code>getdihedral</code></a> <a href="#ProtoSyn.rotate_dihedral!"><code>rotate_dihedral!</code></a></p><p><strong>Examples</strong></p><pre><code class="language-julia-repl">julia&gt; setdihedral!(pose.state, pose.graph[1][1][end], Float64(π))
State{Float64}:
 Size: 343
 i2c: true | c2i: false
 Energy: Dict(:Total =&gt; Inf)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sergio-santos-group/ProtoSyn.jl/blob/3a5f148f31782f4c86c163bc48e475ec9945b7ba/src/Core/Methods/state.jl#L306-L326">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ProtoSyn.rotate_dihedral!" href="#ProtoSyn.rotate_dihedral!"><code>ProtoSyn.rotate_dihedral!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">rotate_dihedral!(state::State, atom::Atom, value::T) where {T &lt;: AbstractFloat}</code></pre><p>Rotate the dihedral in <a href="../../types/#ProtoSyn.Atom"><code>Atom</code></a> <code>atom</code> of <a href="../../types/#ProtoSyn.State"><code>State</code></a> <code>state</code> by <code>value</code> (in radians, <strong>adds</strong> to the current dihedral angle). Automatically requests internal to cartesian coordinate conversion (by setting <code>state.i2c</code> as <code>true</code>). Return the altered <a href="../../types/#ProtoSyn.State"><code>State</code></a> <code>state</code>.</p><p><strong>See also</strong></p><p><a href="../graph/#ProtoSyn.ascendents"><code>ascendents</code></a> <a href="#ProtoSyn.request_i2c!"><code>request_i2c!</code></a> <a href="#ProtoSyn.getdihedral"><code>getdihedral</code></a> <a href="#ProtoSyn.setdihedral!"><code>setdihedral!</code></a></p><p><strong>Examples</strong></p><pre><code class="language-julia-repl">julia&gt; rotate_dihedral!(pose.state, pose.graph[1][1][end], Float64(π))
State{Float64}:
 Size: 343
 i2c: true | c2i: false
 Energy: Dict(:Total =&gt; Inf)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sergio-santos-group/ProtoSyn.jl/blob/3a5f148f31782f4c86c163bc48e475ec9945b7ba/src/Core/Methods/state.jl#L358-L378">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ProtoSyn.setoffset!" href="#ProtoSyn.setoffset!"><code>ProtoSyn.setoffset!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">setoffset!(state::State{T}, at::Atom, default::Number) where {T &lt;: AbstractFloat}</code></pre><p>Rotate all sibling dihedrals of <a href="../../types/#ProtoSyn.Atom"><code>Atom</code></a> <code>atom</code> in the given <a href="../../types/#ProtoSyn.State"><code>State</code></a> <code>state</code> so that the dihedral angle identified by <code>atom</code> is equal to <code>default</code>. Set the <code>i2c</code> flag to <code>true</code> and return the altered <a href="../../types/#ProtoSyn.State"><code>State</code></a> <code>state</code>.</p><p><strong>See also</strong></p><p><a href="../../submodules/builder/#ProtoSyn.LGrammar"><code>LGrammar</code></a></p><p><strong>Examples</strong></p><pre><code class="language-julia-repl">julia&gt; ProtoSyn.setoffset!(pose.state, pose.graph[1][2][&quot;CA&quot;], 3.14)
State{Float64}:
 Size: 343
 i2c: true | c2i: false
 Energy: Dict(:Total =&gt; Inf)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sergio-santos-group/ProtoSyn.jl/blob/3a5f148f31782f4c86c163bc48e475ec9945b7ba/src/Core/Methods/state.jl#L271-L290">source</a></section></article><p><img src="../../../../assets/ProtoSyn-dihedral-rotation.gif" alt="ProtoSyn c&amp;i"/></p><p><strong>Figure 2 |</strong> An illustration of <a href="#ProtoSyn.rotate_dihedral!"><code>rotate_dihedral!</code></a> method in action. This method (as well as <a href="#ProtoSyn.setdihedral!"><code>setdihedral!</code></a>) rotate a dihedral by altering the <code>:Δφ</code> field in the correct <a href="../../types/#ProtoSyn.AtomState"><code>AtomState</code></a> instance. For this example, the <a href="#ProtoSyn.rotate_dihedral!"><code>rotate_dihedral!</code></a> was applied to atom <code>C</code>. The position of this atom, according to the internal coordinates system, is dictated by 3 numbers: the distance, angle and dihedral angle to its <a href="../graph/#ProtoSyn.ascendents"><code>ascendents</code></a>. This last value, the dihedral angle, can be further decomposed in 2 contributions: the <a href="../../types/#ProtoSyn.AtomState"><code>AtomState</code></a> intrinsic dihedral field (<code>:φ</code>) plus the <code>parent</code> <a href="../../types/#ProtoSyn.AtomState"><code>AtomState</code></a> <code>:Δφ</code> field. Since this logic applies to all <a href="../../types/#ProtoSyn.AtomState"><code>AtomState</code></a> instances, both atoms <code>CB</code> and <code>HA</code> of this example also have their position dictated by its <code>parent</code> <a href="../../types/#ProtoSyn.AtomState"><code>AtomState</code></a> <code>:Δφ</code> field, which, in this case, is <code>CA</code>. This means that altering <code>:Δφ</code> in <code>CA</code> will affect the position of <code>C</code>, <code>CB</code> and <code>HA</code> by the same measure, in a concerted manner. This, in essence, means rotating the <code>C-N-CA-C</code> dihedral (or <code>Phi</code> dihedral of the aminoacid, in this example). Note that since we are using internal coordinates, this rotation is also applied to all children <a href="../../types/#ProtoSyn.AtomState"><code>AtomState</code></a> instances, since their position is relative to the <code>parent</code>.</p><h2 id="Measuring-distances,-angles-and-dihedrals"><a class="docs-heading-anchor" href="#Measuring-distances,-angles-and-dihedrals">Measuring distances, angles and dihedrals</a><a id="Measuring-distances,-angles-and-dihedrals-1"></a><a class="docs-heading-anchor-permalink" href="#Measuring-distances,-angles-and-dihedrals" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="ProtoSyn.distance" href="#ProtoSyn.distance"><code>ProtoSyn.distance</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">distance(at1::AtomState, at2::AtomState)</code></pre><p>Calculates the distance between the two <a href="../../types/#ProtoSyn.AtomState"><code>AtomState</code></a> instances (<code>at1</code> and <code>at2</code>), based on the cartesian coordinates. Note: Make sure the corresponding <a href="../../types/#ProtoSyn.Pose"><code>Pose</code></a> instance has been synched (using the <a href="#ProtoSyn.sync!"><code>sync!</code></a> method). Returns result in Angstrom (Å).</p><p><strong>See also</strong></p><p><a href="#ProtoSyn.angle"><code>angle</code></a> <a href="#ProtoSyn.dihedral"><code>dihedral</code></a></p><p><strong>Examples</strong></p><pre><code class="language-julia-repl">julia&gt; d = ProtoSyn.distance(pose.state[1], pose.state[2])
1.0093879999999997</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sergio-santos-group/ProtoSyn.jl/blob/3a5f148f31782f4c86c163bc48e475ec9945b7ba/src/Core/Methods/measure.jl#L4-L20">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ProtoSyn.angle" href="#ProtoSyn.angle"><code>ProtoSyn.angle</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">angle(at1::AtomState, at2::AtomState, at3::AtomState)</code></pre><p>Calculates the angle between the three <a href="../../types/#ProtoSyn.AtomState"><code>AtomState</code></a> instances (<code>at1</code>, <code>at2</code> and <code>at3</code>), based on the cartesian coordinates. Note: Make sure the corresponding <a href="../../types/#ProtoSyn.Pose"><code>Pose</code></a> instance has been synched (using the <a href="#ProtoSyn.sync!"><code>sync!</code></a> method). Returns result in radians.</p><p><strong>See also</strong></p><p><a href="#ProtoSyn.distance"><code>distance</code></a> <a href="#ProtoSyn.dihedral"><code>dihedral</code></a></p><p><strong>Examples</strong></p><pre><code class="language-julia-repl">julia&gt; a = ProtoSyn.angle(pose.state[1], pose.state[2], pose.state[3])
0.6444967663659441</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sergio-santos-group/ProtoSyn.jl/blob/3a5f148f31782f4c86c163bc48e475ec9945b7ba/src/Core/Methods/measure.jl#L26-L42">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ProtoSyn.dihedral" href="#ProtoSyn.dihedral"><code>ProtoSyn.dihedral</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">dihedral(at1::AtomState, at2::AtomState, at3::AtomState, at4::AtomState)</code></pre><p>Calculates the dihedral angle between the four <a href="../../types/#ProtoSyn.AtomState"><code>AtomState</code></a> instances (<code>at1</code>, <code>at2</code>, <code>at3</code> and <code>at4</code>), based on the cartesian coordinates. Note: Make sure the corresponding <a href="../../types/#ProtoSyn.Pose"><code>Pose</code></a> instance has been synched (using the <a href="#ProtoSyn.sync!"><code>sync!</code></a> method). Returns result in radians.</p><p><strong>Examples</strong></p><pre><code class="nohighlight">julia&gt; a = ProtoSyn.dihedral(pose.state[1], pose.state[2], pose.state[3], pose.state[4])
-1.2318251145557122</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sergio-santos-group/ProtoSyn.jl/blob/3a5f148f31782f4c86c163bc48e475ec9945b7ba/src/Core/Methods/measure.jl#L53-L66">source</a></section></article><h2 id="core-state-methods-indexation"><a class="docs-heading-anchor" href="#core-state-methods-indexation">Indexation</a><a id="core-state-methods-indexation-1"></a><a class="docs-heading-anchor-permalink" href="#core-state-methods-indexation" title="Permalink"></a></h2><p>In order to access an <a href="../../types/#ProtoSyn.AtomState"><code>AtomState</code></a> instance in a <a href="../../types/#state-types">State</a>, ProtoSyn makes available, essentially, three methods:</p><ul><li>Using the regular syntax;</li></ul><pre><code class="language-julia-repl">julia&gt; pose.state.items[4]
ERROR: UndefVarError: pose not defined</code></pre><div class="admonition is-category-ukw"><header class="admonition-header">Note:</header><div class="admonition-body"><p>In the <code>items</code> field, <a href="../../types/#ProtoSyn.AtomState"><code>AtomState</code></a> instances are indexed including the Root (which occupies the first three positions). Atom 1 is therefore at index 4. This is taken into account when using the short syntax (recommended).</p></div></div><ul><li>Using the short syntax with index;</li></ul><pre><code class="language-julia-repl">julia&gt; pose.state[1]
ERROR: UndefVarError: pose not defined</code></pre><ul><li>Using the short syntax with an <a href="../../types/#ProtoSyn.Atom"><code>Atom</code></a> instance;</li></ul><pre><code class="language-julia-repl">julia&gt; atom = pose.graph[1, 1, 1]
ERROR: UndefVarError: pose not defined

julia&gt; pose.state[atom]
ERROR: UndefVarError: pose not defined</code></pre><p>Indexation methods make sure the <a href="../../types/#Pose">Pose</a> <a href="../../types/#state-types">State</a> structure remains coherent with the <a href="../../types/#state-types">Graph</a> structure, in terms of order.</p><article class="docstring"><header><a class="docstring-binding" id="ProtoSyn.reindex-Tuple{State}" href="#ProtoSyn.reindex-Tuple{State}"><code>ProtoSyn.reindex</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">reindex(state::State)</code></pre><p>Re-indexes the whole <a href="../../types/#ProtoSyn.State"><code>State</code></a> <code>state</code> (excluding the Root), setting the <code>:index</code> field of <a href="../../types/#ProtoSyn.AtomState"><code>AtomState</code></a> instances. Return the altered <a href="../../types/#ProtoSyn.State"><code>State</code></a> <code>state</code>.</p><div class="admonition is-category-ukw"><header class="admonition-header">Note:</header><div class="admonition-body"><p>Since we are altering a field of <a href="../../types/#ProtoSyn.AtomState"><code>AtomState</code></a> structs, the <code>:changed</code> field will automatically be set to <code>true</code> and therefore be updated in a future <a href="#ProtoSyn.sync!"><code>sync!</code></a> call (if either <code>:i2c</code> or <code>:c2i</code> flag in the corresponding <code>state</code> is set to <code>true</code>).</p></div></div><p><strong>See also</strong></p><p><a href="../graph/#ProtoSyn.reindex-Tuple{Topology}"><code>reindex(::Topology, ::Bool)</code></a></p><p><strong>Examples</strong></p><pre><code class="language-julia-repl">julia&gt; reindex(pose.state)
State{Float64}:
 Size: 343
 i2c: false | c2i: false
 Energy: Dict(:Total =&gt; Inf)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sergio-santos-group/ProtoSyn.jl/blob/3a5f148f31782f4c86c163bc48e475ec9945b7ba/src/Core/Methods/state.jl#L386-L410">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../graph/">« Graph</a><a class="docs-footer-nextpage" href="../pose/">Pose »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Thursday 1 July 2021 15:18">Thursday 1 July 2021</span>. Using Julia version 1.6.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
